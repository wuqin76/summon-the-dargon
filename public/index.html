<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Âè¨Âî§Á•ûÈæô - Dragon Game</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
            background: url('/images/picture1.png') no-repeat center center;
            background-size: cover;
            background-attachment: fixed;
            color: #ffffff;
            min-height: 100vh;
            padding: 0;
            overflow-x: hidden;
            position: relative;
        }
        
        /* Âç∞Â∫¶È£éÊ†ºË£ÖÈ•∞ËÉåÊôØ - Â¢ûÂº∫Áâà */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                radial-gradient(circle at 20% 30%, rgba(255, 153, 51, 0.15) 0%, transparent 50%),
                radial-gradient(circle at 80% 70%, rgba(19, 136, 8, 0.15) 0%, transparent 50%),
                radial-gradient(circle at 50% 50%, rgba(255, 215, 0, 0.08) 0%, transparent 60%);
            pointer-events: none;
            z-index: 0;
        }
        
        /* Â§ö‰∏™ÊºÇÊµÆË£ÖÈ•∞ÂÖÉÁ¥† */
        .floating-elements {
            position: fixed;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            pointer-events: none;
            z-index: 1;
            overflow: hidden;
        }
        
        .floating-elements::before {
            content: 'ü™∑';
            position: absolute;
            font-size: 40px;
            animation: floatFlower1 25s infinite linear;
            opacity: 0.4;
        }
        
        .floating-elements::after {
            content: 'ü¶ö';
            position: absolute;
            font-size: 45px;
            animation: floatFlower2 30s infinite linear;
            opacity: 0.35;
        }
        
        @keyframes floatFlower1 {
            0% { top: -60px; left: 5%; transform: rotate(0deg); }
            50% { left: 85%; transform: rotate(180deg); }
            100% { top: 110vh; left: 15%; transform: rotate(360deg); }
        }
        
        @keyframes floatFlower2 {
            0% { top: -70px; right: 10%; transform: rotate(0deg) scaleX(-1); }
            50% { right: 80%; transform: rotate(180deg) scaleX(-1); }
            100% { top: 110vh; right: 20%; transform: rotate(360deg) scaleX(-1); }
        }

        .container {
            max-width: 600px;
            margin: 0 auto;
            padding: 0;
            padding-bottom: 80px; /* ‰∏∫Â∫ïÈÉ®ÂØºËà™ÁïôÁ©∫Èó¥ */
            position: relative;
            z-index: 2;
            width: 100%;
            min-height: 100vh;
        }
        
        /* È°µÈù¢ÂÆπÂô® */
        .page {
            display: none;
            animation: fadeIn 0.3s ease-in-out;
        }
        
        .page.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Â∫ïÈÉ®ÂØºËà™Ê†è */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(180deg, rgba(0,0,0,0.95) 0%, rgba(0,0,0,0.98) 100%);
            backdrop-filter: blur(10px);
            border-top: 2px solid rgba(255, 153, 51, 0.5);
            display: flex;
            justify-content: space-around;
            padding: 8px 0 max(8px, env(safe-area-inset-bottom));
            z-index: 1000;
            box-shadow: 0 -5px 20px rgba(0,0,0,0.5);
        }
        
        .nav-item {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
            padding: 8px;
            color: rgba(255, 255, 255, 0.6);
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
            background: none;
            font-size: 12px;
            text-decoration: none;
        }
        
        .nav-item.active {
            color: #FF9933;
        }
        
        .nav-item .nav-icon {
            font-size: 24px;
            transition: transform 0.3s ease;
        }
        
        .nav-item.active .nav-icon {
            transform: scale(1.2);
            filter: drop-shadow(0 0 8px rgba(255, 153, 51, 0.8));
        }
        
        @media (max-width: 768px) {
            .container {
                padding-bottom: 75px;
            }
        }

        /* Âç∞Â∫¶È£éÊ†ºÈ°∂ÈÉ®ÊäΩÂ•ñÂå∫Âüü */
        .spin-hero {
            background: linear-gradient(135deg, #FF9933 0%, #FF6B35 50%, #F7931E 100%);
            padding: clamp(20px, 5vw, 35px) clamp(15px, 4vw, 25px);
            position: relative;
            overflow: hidden;
            box-shadow: 0 10px 40px rgba(255, 153, 51, 0.6),
                        0 0 100px rgba(255, 107, 53, 0.3);
            border-bottom: clamp(3px, 0.8vw, 6px) solid #138808;
        }
        
        @media (max-width: 480px) {
            .spin-hero {
                padding: 18px 12px;
            }
        }
        
        /* ÊõºÈôÄÁΩóÂõæÊ°àË£ÖÈ•∞ */
        .spin-hero::after {
            content: '';
            position: absolute;
            top: -100px;
            right: -100px;
            width: 300px;
            height: 300px;
            background: radial-gradient(circle, transparent 30%, rgba(255, 255, 255, 0.1) 30%, transparent 31%),
                        radial-gradient(circle at 50% 50%, rgba(255, 255, 255, 0.05) 0%, transparent 70%);
            border-radius: 50%;
            animation: rotateMandala 30s infinite linear;
            pointer-events: none;
        }
        
        @keyframes rotateMandala {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .spin-hero::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: repeating-linear-gradient(
                45deg,
                transparent,
                transparent 10px,
                rgba(255, 255, 255, 0.03) 10px,
                rgba(255, 255, 255, 0.03) 20px
            );
            animation: slideBackground 20s linear infinite;
        }

        @keyframes slideBackground {
            0% { transform: translate(0, 0); }
            100% { transform: translate(50%, 50%); }
        }

        .spin-hero-content {
            position: relative;
            z-index: 1;
        }

        .spin-title {
            text-align: center;
            font-size: clamp(24px, 6vw, 36px);
            font-weight: 900;
            margin-bottom: 15px;
            text-shadow: 
                0 4px 15px rgba(0, 0, 0, 0.6),
                0 0 30px rgba(255, 153, 51, 0.8),
                0 0 60px rgba(255, 215, 0, 0.4);
            animation: pulse 2s ease-in-out infinite;
            color: #FFFFFF;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            padding: 0 15px;
        }
        
        .spin-title::before,
        .spin-title::after {
            content: 'ü™î';
            font-size: clamp(20px, 5vw, 28px);
            animation: flickerFlame 1.5s ease-in-out infinite;
            filter: drop-shadow(0 0 10px rgba(255, 153, 51, 0.8));
        }
        
        @keyframes flickerFlame {
            0%, 100% { 
                opacity: 0.8; 
                transform: scale(1) translateY(0);
                filter: drop-shadow(0 0 10px rgba(255, 153, 51, 0.8));
            }
            50% { 
                opacity: 1; 
                transform: scale(1.15) translateY(-3px);
                filter: drop-shadow(0 0 20px rgba(255, 153, 51, 1));
            }
        }
        
        @media (max-width: 480px) {
            .spin-title {
                gap: 8px;
            }
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .invite-tip {
            text-align: center;
            font-size: clamp(13px, 3.5vw, 16px);
            margin-bottom: clamp(15px, 4vw, 22px);
            padding: clamp(10px, 2.5vw, 14px) clamp(15px, 4vw, 22px);
            background: rgba(255, 255, 255, 0.25);
            border-radius: 25px;
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255, 255, 255, 0.35);
            animation: tipGlow 2s ease-in-out infinite;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: clamp(10px, 3vw, 15px);
            flex-wrap: wrap;
            line-height: 1.4;
            position: relative;
            z-index: 50;
        }
        
        @media (max-width: 480px) {
            .invite-tip {
                font-size: 13px;
                padding: 10px 15px;
            }
        }

        @keyframes tipGlow {
            0%, 100% { 
                box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
                border-color: rgba(255, 255, 255, 0.3);
            }
            50% { 
                box-shadow: 0 4px 25px rgba(255, 215, 0, 0.4);
                border-color: rgba(255, 215, 0, 0.6);
            }
        }

        .invite-btn {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            border: none;
            padding: clamp(8px, 2vw, 12px) clamp(18px, 5vw, 28px);
            border-radius: 20px;
            font-size: clamp(13px, 3.5vw, 16px);
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(0, 242, 254, 0.4);
            transition: all 0.3s ease;
            white-space: nowrap;
            position: relative;
            z-index: 100;
            pointer-events: auto;
        }

        .invite-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 242, 254, 0.5);
        }

        .invite-btn:active {
            transform: translateY(0);
        }

        .dev-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: clamp(8px, 2vw, 12px) clamp(18px, 5vw, 28px);
            border-radius: 20px;
            font-size: clamp(13px, 3.5vw, 16px);
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
            transition: all 0.3s ease;
            white-space: nowrap;
            position: relative;
            z-index: 100;
            pointer-events: auto;
            margin-left: 10px;
        }

        .dev-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.5);
        }

        /* ÂºÄÂèëËÄÖÈù¢ÊùøÊ†∑Âºè */
        .dev-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(5px);
            z-index: 10000;
            align-items: center;
            justify-content: center;
        }

        .dev-modal.show {
            display: flex;
        }

        .dev-modal-content {
            background: white;
            border-radius: 25px;
            padding: clamp(25px, 6vw, 35px);
            width: 90%;
            max-width: 450px;
            box-shadow: 0 15px 50px rgba(0, 0, 0, 0.3);
            animation: slideUpDev 0.3s ease;
        }

        @keyframes slideUpDev {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .dev-modal-header {
            text-align: center;
            margin-bottom: 25px;
        }

        .dev-modal-header h2 {
            margin: 0;
            font-size: clamp(22px, 5.5vw, 28px);
            background: linear-gradient(135deg, #667eea, #764ba2);
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .dev-buttons {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 20px;
        }

        .dev-action-btn {
            padding: 15px 20px;
            border: none;
            border-radius: 15px;
            font-size: 16px;
            font-weight: bold;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: left;
        }

        .dev-action-btn.grant {
            background: linear-gradient(135deg, #11998e, #38ef7d);
        }

        .dev-action-btn.complete {
            background: linear-gradient(135deg, #4facfe, #00f2fe);
        }

        .dev-action-btn.reset {
            background: linear-gradient(135deg, #fa709a, #fee140);
        }

        .dev-action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
        }

        .dev-action-btn:active {
            transform: translateY(0);
        }

        .dev-info {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 15px;
            margin-top: 15px;
            font-size: 14px;
            color: #333;
        }

        .close-dev-modal-btn {
            width: 100%;
            padding: 12px;
            background: #6c757d;
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            margin-top: 15px;
        }

        /* ËΩ¨ÁõòÂÆπÂô® - ÊñπÂùóÊ†ºÂ≠êÊ†∑Âºè */
        .wheel-container {
            position: relative;
            width: 95vw;
            max-width: 500px;
            margin: 0 auto 30px;
            padding: 20px;
            background: rgba(0, 0, 0, 0.4);
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.6), 0 0 30px rgba(255, 215, 0, 0.3);
        }
        
        @media (max-width: 768px) {
            .wheel-container {
                width: 92vw;
                padding: 15px;
            }
        }
        
        @media (max-width: 480px) {
            .wheel-container {
                width: 95vw;
                padding: 12px;
            }
        }

        .wheel-glow {
            display: none;
        }

        /* ÊñπÂùóÊ†ºÂ≠êËÄÅËôéÊú∫Ê†∑Âºè */
        .wheel {
            width: 100%;
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 8px;
            padding: 10px;
        }
        
        .wheel-inner {
            display: contents;
        }

        /* ÊñπÂùóÊ†ºÂ≠ê */
        .sector {
            aspect-ratio: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 12px;
            font-weight: 900;
            font-size: clamp(16px, 4vw, 24px);
            color: white;
            text-align: center;
            padding: 10px;
            transition: all 0.15s ease;
            box-shadow: 
                0 4px 15px rgba(0, 0, 0, 0.4),
                inset 0 2px 10px rgba(255, 255, 255, 0.2);
            position: relative;
            overflow: hidden;
        }

        .sector::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(255,255,255,0.2), transparent);
            opacity: 0;
            transition: opacity 0.15s ease;
        }

        .sector:hover::before {
            opacity: 1;
        }

        .sector span {
            position: relative;
            z-index: 1;
            text-shadow: 
                0 2px 8px rgba(0, 0, 0, 0.8),
                0 0 15px rgba(255, 255, 255, 0.3);
            font-size: clamp(15px, 3.8vw, 22px);
            font-weight: 900;
            line-height: 1.2;
        }

        /* Ê¥ªË∑ÉÈó™ÁÉÅÁä∂ÊÄÅ */
        .sector.active {
            transform: scale(1.15);
            box-shadow: 
                0 8px 30px rgba(255, 215, 0, 0.8),
                0 0 40px rgba(255, 215, 0, 0.6),
                inset 0 0 20px rgba(255, 255, 255, 0.4);
            z-index: 10;
            animation: slotPulse 0.15s ease;
        }

        @keyframes slotPulse {
            0%, 100% { transform: scale(1.15); }
            50% { transform: scale(1.2); }
        }

        /* Âç∞Â∫¶È£éÊ†ºÊñπÂùóÈÖçËâ≤ - È≤úËâ≥Êòé‰∫Æ */
        .sector:nth-child(1) {
            background: linear-gradient(135deg, #FF6347, #FF4500);
        }

        .sector:nth-child(2) {
            background: linear-gradient(135deg, #FFD700, #FFA500);
        }

        .sector:nth-child(3) {
            background: linear-gradient(135deg, #FF9933, #FF7F00);
        }

        .sector:nth-child(4) {
            background: linear-gradient(135deg, #32CD32, #228B22);
        }

        .sector:nth-child(5) {
            background: linear-gradient(135deg, #FF69B4, #FF1493);
        }

        .sector:nth-child(6) {
            background: linear-gradient(135deg, #FFD700, #FFEC8B);
        }

        .sector:nth-child(7) {
            background: linear-gradient(135deg, #00CED1, #20B2AA);
        }

        .sector:nth-child(8) {
            background: linear-gradient(135deg, #FF6B35, #F7931E);
        }

        .sector:nth-child(9) {
            background: linear-gradient(135deg, #9370DB, #8A2BE2);
        }

        .sector:nth-child(10) {
            background: linear-gradient(135deg, #FF4500, #DC143C);
        }

        .sector:nth-child(11) {
            background: linear-gradient(135deg, #FFD700, #FF8C00);
        }

        .sector:nth-child(12) {
            background: linear-gradient(135deg, #32CD32, #3CB371);
        }

        /* ÊµÖËâ≤ËÉåÊôØÁöÑÊ†ºÂ≠ê‰ΩøÁî®Ê∑±Ëâ≤ÊñáÂ≠ó */
        .sector:nth-child(2) span,
        .sector:nth-child(3) span,
        .sector:nth-child(6) span,
        .sector:nth-child(11) span {
            color: #1a1a1a;
            text-shadow: 
                0 2px 6px rgba(255, 255, 255, 0.8),
                0 0 10px rgba(255, 255, 255, 0.5);
        }

        /* RandomÊ†ºÂ≠êÁâπÊÆäÊ†∑Âºè - ÂΩ©ËôπÊ∏êÂèò */
        .sector:nth-child(11) {
            background: linear-gradient(135deg, 
                #ff0000 0%, 
                #ff7f00 14%, 
                #ffff00 28%, 
                #00ff00 42%, 
                #0000ff 56%, 
                #4b0082 70%, 
                #9400d3 84%, 
                #ff0000 100%);
            background-size: 200% 200%;
            animation: rainbowShift 3s ease infinite;
        }

        @keyframes rainbowShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .wheel-center {
            display: none;
        }

        /* ÊåáÈíàÊ†∑ÂºèË∞ÉÊï¥‰∏∫‰∏çÊòæÁ§∫ */
        .pointer {
            display: none;
        }

        .spin-btn {
            display: block;
            width: 88%;
            max-width: 360px;
            margin: 0 auto clamp(15px, 4vw, 25px);
            padding: clamp(16px, 4.5vw, 24px) clamp(30px, 8vw, 50px);
            background: linear-gradient(135deg, #FF9933 0%, #FFD700 50%, #FF9933 100%);
            background-size: 200% 100%;
            border: clamp(3px, 0.8vw, 5px) solid #FFFFFF;
            border-radius: 50px;
            font-size: clamp(18px, 5vw, 26px);
            font-weight: 900;
            color: #FFFFFF;
            text-shadow: 
                0 3px 6px rgba(0, 0, 0, 0.4),
                0 0 15px rgba(255, 153, 51, 0.6);
            cursor: pointer;
            box-shadow: 
                0 10px 35px rgba(255, 153, 51, 0.7),
                0 0 50px rgba(255, 153, 51, 0.5),
                inset 0 3px 12px rgba(255, 255, 255, 0.4);
            transition: all 0.3s ease;
            animation: btnShine 3s ease-in-out infinite;
        }
        
        @media (max-width: 480px) {
            .spin-btn {
                width: 85%;
                padding: 16px 35px;
                font-size: 18px;
            }
        }

        @keyframes btnShine {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        .spin-btn:hover:not(:disabled) {
            transform: translateY(-3px);
            box-shadow: 0 15px 40px rgba(255, 215, 0, 0.7);
        }

        .spin-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            animation: none;
        }

        .spin-status {
            text-align: center;
            font-size: 16px;
            margin-top: 15px;
            padding: 12px 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            backdrop-filter: blur(10px);
        }

        .header {
            text-align: center;
            padding: 35px 20px 25px;
        }

        .game-content {
            padding: 0 20px;
        }

        .header h1 {
            font-size: 38px;
            margin-bottom: 12px;
            text-shadow: 0 3px 15px rgba(0, 0, 0, 0.4);
            font-weight: 900;
        }

        .header p {
            font-size: 18px;
            opacity: 0.95;
        }



        /* Ê∏∏ÊàèÊ®°ÂºèÂç°Áâá */
        .modes-container {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin-top: 25px;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        .mode-card {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 25px 20px;
            position: relative;
            overflow: hidden;
            transition: all 0.3s;
            cursor: pointer;
            border: 2px solid transparent;
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 100%;
        }

        .mode-card:hover {
            transform: translateY(-3px);
            background: rgba(255, 255, 255, 0.2);
            border-color: rgba(255, 255, 255, 0.3);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
        }

        .mode-badge {
            position: absolute;
            top: 12px;
            right: 12px;
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 11px;
            font-weight: bold;
        }

        .mode-badge.free {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        }

        .mode-icon {
            font-size: 55px;
            margin-bottom: 12px;
        }

        .mode-title {
            font-size: 22px;
            font-weight: bold;
            margin-bottom: 8px;
            text-align: center;
        }

        .mode-price {
            font-size: 30px;
            font-weight: bold;
            margin: 12px 0;
            color: #ffd700;
            text-shadow: 0 2px 10px rgba(255, 215, 0, 0.5);
        }

        .mode-features {
            list-style: none;
            margin: 15px 0;
            text-align: left;
            width: 100%;
        }

        .mode-features li {
            padding: 6px 0;
            padding-left: 22px;
            position: relative;
            font-size: 13px;
            opacity: 0.9;
        }

        .mode-features li:before {
            content: "‚úì";
            position: absolute;
            left: 0;
            color: #4ade80;
            font-weight: bold;
        }

        .mode-features li.disabled-feature:before {
            content: "‚úó";
            color: #ef4444;
        }

        .play-btn {
            width: 100%;
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            border: none;
            color: white;
            padding: 14px 25px;
            border-radius: 20px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 20px;
            box-shadow: 0 4px 15px rgba(245, 87, 108, 0.4);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .play-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(245, 87, 108, 0.5);
        }

        .play-btn.free-btn {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            box-shadow: 0 4px 15px rgba(79, 172, 254, 0.4);
        }
        
        .play-btn.free-btn:hover {
            box-shadow: 0 6px 20px rgba(79, 172, 254, 0.5);
        }

        .info-box {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            margin-top: 30px;
            text-align: center;
        }

        .info-box h3 {
            font-size: 18px;
            margin-bottom: 10px;
        }

        .info-box p {
            font-size: 14px;
            opacity: 0.8;
            line-height: 1.6;
        }

        .payment-notice {
            background: rgba(255, 193, 7, 0.2);
            border: 2px solid rgba(255, 193, 7, 0.5);
            border-radius: 15px;
            padding: 15px;
            margin-top: 15px;
            text-align: center;
        }

        .payment-notice p {
            margin: 5px 0;
            font-size: 14px;
        }



        /* ÊäΩÂ•ñÁªìÊûúÂºπÁ™ó */
        .result-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.85);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            backdrop-filter: blur(10px);
        }

        .result-modal.show {
            display: flex;
        }

        .result-content {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 40px 30px;
            border-radius: 30px;
            text-align: center;
            max-width: 400px;
            width: 90%;
            color: #fff;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
            animation: modalSlideIn 0.5s ease-out;
        }

        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: translateY(-50px) scale(0.8);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .result-content h2 {
            font-size: 36px;
            margin-bottom: 20px;
        }

        .prize-amount {
            font-size: 56px;
            font-weight: bold;
            color: #ffd700;
            margin: 20px 0;
            text-shadow: 0 5px 15px rgba(255, 215, 0, 0.5);
            animation: prizeGlow 1.5s ease-in-out infinite;
        }

        @keyframes prizeGlow {
            0%, 100% { text-shadow: 0 5px 15px rgba(255, 215, 0, 0.5); }
            50% { text-shadow: 0 5px 25px rgba(255, 215, 0, 0.9); }
        }

        .result-message {
            font-size: 18px;
            margin: 20px 0;
            opacity: 0.9;
        }

        .close-modal-btn {
            background: linear-gradient(135deg, #ffd700, #ffed4e);
            color: #333;
            border: none;
            padding: 15px 40px;
            border-radius: 30px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            margin-top: 20px;
            box-shadow: 0 5px 20px rgba(255, 215, 0, 0.4);
            transition: all 0.3s;
        }

        .close-modal-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(255, 215, 0, 0.6);
        }

        /* ËÉΩÈáèÊù°Ê†∑Âºè */
        .energy-container {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 25px;
            margin-top: 25px;
            border: 2px solid rgba(255, 255, 255, 0.2);
        }

        .energy-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .energy-title {
            font-size: 18px;
            font-weight: bold;
        }

        .energy-value {
            font-size: 20px;
            font-weight: 900;
            color: #ffd700;
            text-shadow: 0 2px 8px rgba(255, 215, 0, 0.5);
        }

        .energy-bar-wrapper {
            width: 100%;
            height: 40px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 20px;
            overflow: hidden;
            box-shadow: inset 0 2px 10px rgba(0, 0, 0, 0.5);
            position: relative;
        }

        .energy-bar {
            height: 100%;
            background: linear-gradient(90deg, #4ade80 0%, #22c55e 50%, #16a34a 100%);
            border-radius: 20px;
            transition: width 0.8s ease;
            position: relative;
            box-shadow: 0 0 20px rgba(74, 222, 128, 0.6);
            animation: energyPulse 2s ease-in-out infinite;
        }

        @keyframes energyPulse {
            0%, 100% {
                box-shadow: 0 0 20px rgba(74, 222, 128, 0.6);
            }
            50% {
                box-shadow: 0 0 30px rgba(74, 222, 128, 0.9);
            }
        }

        .energy-shine {
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            animation: shine 3s infinite;
        }

        @keyframes shine {
            0% {
                left: -100%;
            }
            100% {
                left: 200%;
            }
        }

        .energy-tip {
            text-align: center;
            font-size: 15px;
            margin-top: 15px;
            padding: 12px;
            background: rgba(255, 215, 0, 0.15);
            border-radius: 15px;
            border: 1px solid rgba(255, 215, 0, 0.3);
        }

        .task-btn {
            width: 100%;
            background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            margin-top: 15px;
            box-shadow: 0 5px 20px rgba(139, 92, 246, 0.4);
            transition: all 0.3s ease;
        }

        .task-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(139, 92, 246, 0.6);
        }

        /* ÈÇÄËØ∑ÈìæÊé•ÂÆπÂô® */
        .invite-link-container {
            display: flex;
            gap: 10px;
            margin: 20px 0;
            background: rgba(255, 255, 255, 0.1);
            padding: 10px;
            border-radius: 15px;
        }

        .invite-link-input {
            flex: 1;
            background: rgba(255, 255, 255, 0.9);
            border: none;
            padding: 12px 15px;
            border-radius: 10px;
            font-size: 14px;
            color: #333;
            font-family: monospace;
        }

        .copy-btn {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 10px;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
            white-space: nowrap;
            transition: all 0.3s;
        }

        .copy-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 242, 254, 0.4);
        }

        .copy-btn.copied {
            background: linear-gradient(135deg, #4ade80 0%, #22c55e 100%);
        }

        /* ÈÇÄËØ∑ÁªüËÆ° */
        .invite-stats {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin: 20px 0;
        }

        .stat-item {
            text-align: center;
            padding: 15px 25px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            min-width: 100px;
        }

        .stat-value {
            font-size: 32px;
            font-weight: bold;
            color: #ffd700;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 14px;
            opacity: 0.8;
        }

        /* ‰ªªÂä°ÂºπÁ™óÊ†∑Âºè */
        .task-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            backdrop-filter: blur(10px);
        }

        .task-modal.show {
            display: flex;
        }

        .task-modal-content {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            padding: 40px 30px;
            border-radius: 30px;
            max-width: 450px;
            width: 90%;
            color: #fff;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
            border: 2px solid rgba(255, 215, 0, 0.3);
            animation: modalSlideIn 0.5s ease-out;
        }

        .task-modal-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .task-modal-header h2 {
            font-size: 32px;
            margin-bottom: 15px;
            text-shadow: 0 3px 10px rgba(255, 215, 0, 0.5);
        }

        .task-modal-header p {
            font-size: 15px;
            opacity: 0.85;
            line-height: 1.6;
        }

        .current-task-card {
            background: rgba(255, 215, 0, 0.1);
            border: 3px solid rgba(255, 215, 0, 0.5);
            border-radius: 20px;
            padding: 30px 25px;
            margin-bottom: 25px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(255, 215, 0, 0.2);
        }

        .task-type-badge {
            display: inline-block;
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            padding: 6px 18px;
            border-radius: 15px;
            font-size: 13px;
            font-weight: bold;
            margin-bottom: 15px;
        }

        .task-type-badge.initial {
            background: linear-gradient(135deg, #ffd700 0%, #ffed4e 100%);
            color: #333;
        }

        .task-type-badge.optional {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        }

        .task-name {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 12px;
            color: #ffd700;
        }

        .task-description {
            font-size: 16px;
            opacity: 0.9;
            line-height: 1.6;
            margin-bottom: 20px;
        }

        .task-progress-bar {
            width: 100%;
            height: 12px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 10px;
        }

        .task-progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #4ade80 0%, #22c55e 100%);
            border-radius: 10px;
            transition: width 0.5s ease;
            box-shadow: 0 0 10px rgba(74, 222, 128, 0.6);
        }

        .task-progress-text {
            font-size: 14px;
            opacity: 0.8;
            margin-bottom: 20px;
        }

        .task-action-buttons {
            display: flex;
            gap: 12px;
            margin-top: 20px;
        }

        .task-action-btn {
            flex: 1;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 25px;
            border-radius: 20px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
        }

        .task-action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.6);
        }

        .task-action-btn.primary {
            background: linear-gradient(135deg, #ffd700 0%, #ffed4e 100%);
            color: #333;
            box-shadow: 0 5px 20px rgba(255, 215, 0, 0.4);
        }

        .task-action-btn.primary:hover {
            box-shadow: 0 8px 25px rgba(255, 215, 0, 0.6);
        }

        .task-info-box {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 25px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .task-info-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .task-info-item:last-child {
            border-bottom: none;
        }

        .task-info-label {
            font-size: 14px;
            opacity: 0.8;
        }

        .task-info-value {
            font-size: 16px;
            font-weight: bold;
            color: #ffd700;
        }

        .close-task-modal-btn {
            width: 100%;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.2);
            padding: 15px 30px;
            border-radius: 20px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 15px;
        }

        .close-task-modal-btn:hover {
            background: rgba(255, 255, 255, 0.15);
            border-color: rgba(255, 255, 255, 0.3);
        }

        .task-hint {
            text-align: center;
            font-size: 13px;
            opacity: 0.7;
            margin-top: 15px;
            font-style: italic;
        }
        
        /* ÊéíË°åÊ¶úÊ†∑Âºè */
        .leaderboard-container {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 20px;
            padding: 20px 15px;
            margin-top: 20px;
        }
        
        .leaderboard-item {
            background: linear-gradient(135deg, rgba(255, 153, 51, 0.1) 0%, rgba(19, 136, 8, 0.1) 100%);
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 15px;
            border: 1px solid rgba(255, 153, 51, 0.3);
            transition: all 0.3s ease;
        }
        
        .leaderboard-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(255, 153, 51, 0.3);
        }
        
        .leaderboard-rank {
            font-size: 24px;
            font-weight: 900;
            min-width: 40px;
            text-align: center;
            background: linear-gradient(135deg, #FFD700 0%, #FFA500 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .leaderboard-rank.top-1 {
            font-size: 32px;
        }
        
        .leaderboard-rank.top-1::before {
            content: 'ü•á ';
            -webkit-text-fill-color: initial;
        }
        
        .leaderboard-rank.top-2::before {
            content: 'ü•à ';
            -webkit-text-fill-color: initial;
        }
        
        .leaderboard-rank.top-3::before {
            content: 'ü•â ';
            -webkit-text-fill-color: initial;
        }
        
        .leaderboard-info {
            flex: 1;
        }
        
        .leaderboard-name {
            font-size: 16px;
            font-weight: bold;
            color: #FFFFFF;
            margin-bottom: 4px;
        }
        
        .leaderboard-detail {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.6);
        }
        
        .leaderboard-amount {
            font-size: 20px;
            font-weight: 900;
            color: #FFD700;
            text-align: right;
        }
        
        .leaderboard-status {
            font-size: 11px;
            padding: 4px 10px;
            border-radius: 10px;
            margin-top: 4px;
            display: inline-block;
        }
        
        .leaderboard-status.pending {
            background: rgba(255, 193, 7, 0.2);
            color: #FFC107;
        }
        
        .leaderboard-status.completed {
            background: rgba(76, 175, 80, 0.2);
            color: #4CAF50;
        }
        
        /* Âç∞Â∫¶Ë£ÖÈ•∞ÂÖÉÁ¥† - ÊéíÁÅØËäÇÁÅØÁ¨º */
        .diya-decoration {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 60px;
            display: flex;
            justify-content: space-around;
            align-items: center;
            z-index: 1000;
            pointer-events: none;
        }
        
        .diya {
            font-size: 28px;
            animation: diyaGlow 2s ease-in-out infinite;
            filter: drop-shadow(0 0 10px rgba(255, 153, 51, 0.8));
        }
        
        .diya:nth-child(2) { animation-delay: 0.3s; }
        .diya:nth-child(3) { animation-delay: 0.6s; }
        .diya:nth-child(4) { animation-delay: 0.9s; }
        .diya:nth-child(5) { animation-delay: 1.2s; }
        
        @keyframes diyaGlow {
            0%, 100% { 
                opacity: 0.7; 
                transform: translateY(0) scale(1);
                filter: drop-shadow(0 0 10px rgba(255, 153, 51, 0.6));
            }
            50% { 
                opacity: 1; 
                transform: translateY(-5px) scale(1.1);
                filter: drop-shadow(0 0 20px rgba(255, 153, 51, 1));
            }
        }

        @keyframes scrollText {
            0% { 
                transform: translateX(100%); 
            }
            100% { 
                transform: translateX(-100%); 
            }
        }
    </style>
</head>

<body>
    <!-- ÊºÇÊµÆË£ÖÈ•∞ÂÖÉÁ¥†ÂÆπÂô® -->
    <div class="floating-elements"></div>
    
    <!-- ÊéíÁÅØËäÇÁÅØÁ¨ºË£ÖÈ•∞ -->
    <div class="diya-decoration">
        <span class="diya">ü™î</span>
        <span class="diya">ü™î</span>
        <span class="diya">ü™î</span>
        <span class="diya">ü™î</span>
        <span class="diya">ü™î</span>
    </div>
    
    <div class="container indian-border">
        
        <!-- È°µÈù¢1ÔºöÊ∏∏ÊàèÈ°µ -->
        <div class="page active" id="gamePage">
            <div class="game-content" style="padding-top: 30px;">
                <div class="header">
                    <h1>üê≤ Âè¨Âî§Á•ûÈæô</h1>
                    <p>ÈÄâÊã©Ê∏∏ÊàèÊ®°ÂºèÂºÄÂßã‰Ω†ÁöÑÂÜíÈô©</p>
                </div>

                <!-- ÊàêÂäüÊèêÁé∞ÈÄöÁü•ÊªöÂä®Ê°Ü - ‰∏ªÈ°µ -->
                <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 15px; padding: 15px; margin-bottom: 20px; box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3); overflow: hidden;">
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <div style="font-size: 24px;">üéâ</div>
                        <div style="flex: 1; overflow: hidden;">
                            <div data-withdrawal-notice style="color: white; font-size: 14px; white-space: nowrap; animation: scrollText 12s linear infinite;">
                                Âä†ËΩΩ‰∏≠...
                            </div>
                        </div>
                    </div>
                </div>

                <div class="modes-container">
                <!-- ‰ªòË¥πÊ®°ÂºèÔºàÈ¶ñÊ¨°ÂÖçË¥πÔºâ-->
                <div class="mode-card" id="paidModeCard">
                    <div class="mode-badge" id="modeBadge">È¶ñÊ¨°ÂÖçË¥π</div>
                    <div class="mode-icon">üíé</div>
                    <div class="mode-title">‰ªòË¥πÊ∏∏Áé©</div>
                    <div class="mode-price" id="modePrice">
                        <span style="text-decoration: line-through; opacity: 0.5; font-size: 18px;">10 USDT</span>
                        <span style="color: #FFD700; font-size: 32px; font-weight: bold;">FREE</span>
                    </div>
                    <div style="background: linear-gradient(135deg, #FF6B6B, #FF8E53); padding: 20px; border-radius: 20px; margin: 15px 0; box-shadow: 0 8px 25px rgba(255, 107, 107, 0.4); border: 3px solid rgba(255, 255, 255, 0.3); position: relative; overflow: hidden;">
                        <div style="position: absolute; top: -50%; right: -50%; width: 200%; height: 200%; background: radial-gradient(circle, rgba(255,255,255,0.2) 0%, transparent 70%); animation: shine 3s infinite;"></div>
                        <div style="position: relative; z-index: 1; text-align: center;">
                            <div style="font-size: 40px; margin-bottom: 10px; filter: drop-shadow(0 4px 6px rgba(0,0,0,0.3));">üéÅ</div>
                            <p style="font-size: 20px; font-weight: 900; color: #FFF; margin: 0; text-shadow: 2px 2px 4px rgba(0,0,0,0.3); letter-spacing: 1px;">È¶ñÊ¨°ÂèÇ‰∏éÂç≥ÈÄÅ</p>
                            <p style="font-size: 28px; font-weight: 900; color: #FFD700; margin: 8px 0 0 0; text-shadow: 3px 3px 6px rgba(0,0,0,0.5); letter-spacing: 2px; animation: pulse 1.5s infinite;">ÂÖçË¥πÊäΩÂ•ñÊú∫‰ºöÔºÅ</p>
                        </div>
                    </div>
                    <ul class="mode-features">
                        <li>‚ú® È¶ñÊ¨°Ê∏∏Áé©ÂÆåÂÖ®ÂÖçË¥π</li>
                        <li>üé∞ Ê∏∏ÊàèÁªìÊùüÁ´ãÂç≥ÊäΩÂ•ñ</li>
                        <li>üí∞ ÊúÄÈ´òÂèØËµ¢ ‚Çπ8.88Cr Âç¢ÊØî</li>
                        <li>üéâ Â§öÊ°£Â•ñÈáëÁ≠â‰Ω†Êãø</li>
                    </ul>
                    <button class="play-btn" id="paidPlayBtn" onclick="event.stopPropagation(); handleFirstPlay();" style="background: linear-gradient(135deg, #FFD700, #FFA500); font-size: 18px; font-weight: bold;">
                        üéÆ <span id="playBtnText">Á´ãÂç≥ÂÖçË¥πÊ∏∏Áé©</span>
                    </button>
                    <div class="payment-notice" id="paymentNotice" style="display: none;">
                        <p>‚ö†Ô∏è ÂêéÁª≠Ê∏∏Áé©ÈúÄË¶ÅÊîØ‰ªò 10 USDT</p>
                        <p style="margin-top: 10px; font-size: 12px; opacity: 0.8;">ÁÇπÂáªÊåâÈíÆÂêéÂ∞ÜË∑≥ËΩ¨Âà∞Á¨¨‰∏âÊñπÊîØ‰ªòÈ°µÈù¢</p>
                    </div>
                </div>
            </div>

                <div class="info-box">
                    <h3>üìã Ê∏∏ÊàèËßÑÂàô</h3>
                    <p>
                        <strong>üéÅ È¶ñÊ¨°ÂÖçË¥πÔºö</strong>Êñ∞Áî®Êà∑È¶ñÊ¨°Ê∏∏Áé©ÂÆåÂÖ®ÂÖçË¥πÔºåÊ∏∏ÊàèÁªìÊùüÂêéÁ´ãÂç≥Ëé∑Âæó‰∏ÄÊ¨°ÊäΩÂ•ñÊú∫‰ºöÔºÅ<br><br>
                        <strong>üí∞ ÂêéÁª≠Ê∏∏Áé©Ôºö</strong>ÊîØ‰ªò ‚Çπ1000 Âç¢ÊØîÂç≥ÂèØÁªßÁª≠Ê∏∏Áé©ÔºåÊØèÊ¨°ÈÄöÂÖ≥ÈÉΩËÉΩËé∑ÂæóÊäΩÂ•ñÊú∫‰ºöÔºå
                        ÊúâÊú∫‰ºöËµ¢ÂèñÈ´òËææ ‚Çπ8.88 Crore (8.88‰∫øÂç¢ÊØî) Ë∂ÖÁ∫ßÂ§ßÂ•ñÔºåËøòÊúâÂ§öÊ°£Â•ñÈáëÁ≠â‰Ω†ÊãøÔºåÂø´Êù•ËØïËØïÊâãÊ∞îÔºÅ
                    </p>
                </div>
            </div>
        </div>

        <!-- È°µÈù¢2ÔºöÊäΩÂ•ñÈ°µ -->
        <div class="page" id="spinPage">
            <div class="spin-hero" style="padding-bottom: 25px;">
                <div class="spin-hero-content">
                    <!-- È°∂ÈÉ®Ê†áÈ¢òÂå∫ -->
                    <div class="spin-title" style="margin-bottom: 20px;">üé∞ ‡§≠‡§æ‡§ó‡•ç‡§Ø ‡§ö‡§ï‡•ç‡§∞ üé∞</div>
                    
                    <!-- ÊàêÂäüÊèêÁé∞ÈÄöÁü•ÊªöÂä®Ê°Ü - ÊäΩÂ•ñÈ°µ -->
                    <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 15px; padding: 12px; margin-bottom: 15px; box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3); overflow: hidden;">
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <div style="font-size: 20px;">üéâ</div>
                            <div style="flex: 1; overflow: hidden;">
                                <div data-withdrawal-notice style="color: white; font-size: 13px; white-space: nowrap; animation: scrollText 12s linear infinite;">
                                    Âä†ËΩΩ‰∏≠...
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- ÊäΩÂ•ñÊ¨°Êï∞ÊòæÁ§∫ -->
                    <div style="text-align: center; margin-bottom: 20px;">
                        <div style="display: inline-block; background: rgba(255, 215, 0, 0.15); border: 2px solid rgba(255, 215, 0, 0.5); border-radius: 15px; padding: 12px 25px;">
                            <div style="font-size: 14px; opacity: 0.9; margin-bottom: 5px;">ÂèØÁî®ÊäΩÂ•ñÊ¨°Êï∞</div>
                            <div style="font-size: 32px; font-weight: 900; color: #FFD700; text-shadow: 0 0 20px rgba(255, 215, 0, 0.5);"><span id="availableSpins">0</span> Ê¨°</div>
                        </div>
                    </div>
                    
                    <!-- ËΩ¨Áõò - ÊñπÂùóÊ†ºÂ≠êËÄÅËôéÊú∫ -->
                    <div class="wheel-container" style="margin: 25px auto;">
                        <div class="wheel" id="wheel">
                            <div class="wheel-inner">
                                <div class="sector" data-index="0"><span>‚Çπ8.88Cr</span></div>
                                <div class="sector" data-index="1"><span>‚Çπ88.8L</span></div>
                                <div class="sector" data-index="2"><span>‚Çπ18.8L</span></div>
                                <div class="sector" data-index="3"><span>‚Çπ8.8L</span></div>
                                <div class="sector" data-index="4"><span>‚Çπ1.8L</span></div>
                                <div class="sector" data-index="5"><span>‚Çπ80K</span></div>
                                <div class="sector" data-index="6"><span>‚Çπ30K</span></div>
                                <div class="sector" data-index="7"><span>‚Çπ10K</span></div>
                                <div class="sector" data-index="8"><span>‚Çπ9.9K</span></div>
                                <div class="sector" data-index="9"><span>‚Çπ7K</span></div>
                                <div class="sector" data-index="10"><span>üé≤ Random</span></div>
                                <div class="sector" data-index="11"><span>‚Çπ99</span></div>
                            </div>
                        </div>
                    </div>

                    <!-- ÊäΩÂ•ñÊåâÈíÆ -->
                    <button class="spin-btn" id="spinBtn" onclick="handleSpin()" style="margin: 20px auto; display: block;">
                        üé≤ Á´ãÂç≥ÊäΩÂ•ñ üé≤
                    </button>
                    
                    <!-- Áä∂ÊÄÅÊèêÁ§∫ -->
                    <div class="spin-status" id="spinStatus" style="margin-bottom: 25px;">
                        üí° ÈÇÄËØ∑Â•ΩÂèãÊàñ‰ªòË¥πÊ∏∏Áé©Ëé∑ÂæóÊäΩÂ•ñÊú∫‰ºöÔºÅ
                    </div>

                    <!-- Êìç‰ΩúÊåâÈíÆÁªÑ -->
                    <div style="display: flex; gap: 12px; justify-content: center; margin-bottom: 25px; flex-wrap: wrap; padding: 0 15px;">
                        <button class="invite-btn" onclick="showInviteLink()" style="flex: 1; min-width: 140px; max-width: 200px;">
                            üë• ÈÇÄËØ∑Â•ΩÂèã
                        </button>
                        <button class="invite-btn" onclick="showTaskModal()" style="flex: 1; min-width: 140px; max-width: 200px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);">
                            üìã Êü•Áúã‰ªªÂä°
                        </button>
                        <button class="dev-btn" id="devBtn" onclick="toggleDevPanel()" style="display: none; flex: 1; min-width: 140px; max-width: 200px;">
                            üõ†Ô∏è ÂºÄÂèëËÄÖ
                        </button>
                    </div>

                    <!-- ÊèêÁé∞ÊåâÈíÆÂå∫Âüü -->
                    <div style="margin-top: 30px; padding: 25px; background: linear-gradient(135deg, rgba(255, 215, 0, 0.15), rgba(255, 165, 0, 0.15)); border-radius: 20px; box-shadow: 0 8px 25px rgba(255, 215, 0, 0.3); border: 2px solid rgba(255, 215, 0, 0.3);">
                        <div style="display: flex; align-items: center; justify-content: space-between; gap: 20px;">
                            <div style="flex: 1; text-align: center; padding: 15px; background: rgba(255, 215, 0, 0.2); border-radius: 15px; border: 2px solid rgba(255, 215, 0, 0.4);">
                                <div style="font-size: 14px; font-weight: bold; color: #FFD700; margin-bottom: 8px; text-shadow: 0 2px 4px rgba(0,0,0,0.3);">üéÅ ÊàëÁöÑÂ•ñÈáë</div>
                                <div id="withdrawBalance" style="font-size: 32px; font-weight: 900; color: #FFD700; text-shadow: 0 3px 10px rgba(255, 215, 0, 0.8), 0 0 20px rgba(255, 215, 0, 0.5); letter-spacing: 1px;">‚Çπ0</div>
                            </div>
                            <button class="task-btn" id="withdrawBtn" onclick="handleWithdraw()" style="flex: 1; background: linear-gradient(135deg, #FFD700, #FFA500); font-size: 20px; font-weight: bold; padding: 25px 20px; box-shadow: 0 6px 20px rgba(255, 215, 0, 0.5); border: 3px solid rgba(255, 255, 255, 0.3);">
                                üí∞ Áî≥ËØ∑ÊèêÁé∞
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- È°µÈù¢3ÔºöÊéíË°åÊ¶ú -->
        <div class="page" id="leaderboardPage">
            <div class="game-content" style="padding-top: 20px;">
                <div class="header">
                    <h1>üèÜ ÊèêÁé∞ÊéíË°åÊ¶ú</h1>
                    <p>ÂÆûÊó∂ÊèêÁé∞Êï∞ÊçÆÔºåÂÖ¨ÂºÄÈÄèÊòé</p>
                </div>

                <!-- ÊàêÂäüÊèêÁé∞ÈÄöÁü•ÊªöÂä®Ê°Ü -->
                <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 15px; padding: 15px; margin-bottom: 20px; box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3); overflow: hidden;">
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <div style="font-size: 24px;">üéâ</div>
                        <div style="flex: 1; overflow: hidden;">
                            <div data-withdrawal-notice style="color: white; font-size: 14px; white-space: nowrap; animation: scrollText 12s linear infinite;">
                                Âä†ËΩΩ‰∏≠...
                            </div>
                        </div>
                    </div>
                </div>

                <div class="leaderboard-container" id="leaderboardContainer">
                    <div style="text-align: center; padding: 40px 20px; color: rgba(255,255,255,0.6);">
                        <div style="font-size: 48px; margin-bottom: 15px;">üìä</div>
                        <p>Âä†ËΩΩ‰∏≠...</p>
                    </div>
                </div>

                <div class="info-box" style="margin-top: 20px;">
                    <h3>üí° ËØ¥Êòé</h3>
                    <p>
                        ‚Ä¢ ÊéíË°åÊ¶úÊòæÁ§∫ÊâÄÊúâÁé©ÂÆ∂ÁöÑÊèêÁé∞ËÆ∞ÂΩï<br>
                        ‚Ä¢ Êï∞ÊçÆÂÆûÊó∂Êõ¥Êñ∞ÔºåÂÖ¨Âπ≥ÂÖ¨Ê≠£<br>
                        ‚Ä¢ Á¥ØËÆ°Êª° ‚Çπ10K Âç¢ÊØîÂç≥ÂèØÁî≥ËØ∑ÊèêÁé∞<br>
                        ‚Ä¢ ÊèêÁé∞ÂÆ°Ê†∏ÈÄöËøáÂêé24Â∞èÊó∂ÂÜÖÂà∞Ë¥¶
                    </p>
                </div>
            </div>
        </div>

        <!-- Â∫ïÈÉ®ÂØºËà™Ê†è -->
        <div class="bottom-nav">
            <button class="nav-item active" onclick="switchPage('gamePage', event)">
                <div class="nav-icon">üéÆ</div>
                <div>Ê∏∏Êàè</div>
            </button>
            <button class="nav-item" onclick="switchPage('spinPage', event)">
                <div class="nav-icon">üé∞</div>
                <div>ÊäΩÂ•ñ</div>
            </button>
            <button class="nav-item" onclick="switchPage('leaderboardPage', event)">
                <div class="nav-icon">üèÜ</div>
                <div>ÊéíË°åÊ¶ú</div>
            </button>
        </div>

    </div>

    <!-- ÊäΩÂ•ñÁªìÊûúÂºπÁ™ó -->
    <div class="result-modal" id="resultModal">
        <div class="result-content">
            <h2>üéâ ÊÅ≠Âñú‰∏≠Â•ñÔºÅ</h2>
            <div class="prize-amount" id="prizeAmount">9900 Âç¢ÊØî</div>
            <div class="result-message" id="prizeMessage">
                ‰Ω†Ëµ¢Âæó‰∫ÜÂ•ñÂä±ÔºÅ<br>
                ÂÆåÊàê‰ªªÂä°Âç≥ÂèØÊèêÁé∞ÔºÅ
            </div>
            <button class="close-modal-btn" onclick="closeResultModal()">Â§™Ê£í‰∫ÜÔºÅ</button>
        </div>
    </div>

    <!-- ÈÇÄËØ∑ÈìæÊé•ÂºπÁ™ó -->
    <div class="result-modal" id="inviteModal">
        <div class="result-content">
            <h2>üë• ÈÇÄËØ∑Â•ΩÂèã</h2>
            <p style="margin: 20px 0; font-size: 16px; opacity: 0.9;">
                ÂàÜ‰∫´‰Ω†ÁöÑ‰∏ìÂ±ûÈÇÄËØ∑ÈìæÊé•ÁªôÂ•ΩÂèã<br>
                Â•ΩÂèãÈÄöËøáÈìæÊé•ËøõÂÖ•Ê∏∏ÊàèÔºå‰Ω†Âç≥ÂèØËé∑ÂæóÊäΩÂ•ñÊú∫‰ºöÔºÅ
            </p>
            <div class="invite-link-container">
                <input type="text" id="inviteLink" readonly class="invite-link-input">
                <button class="copy-btn" onclick="copyInviteLink()">
                    üìã Â§çÂà∂
                </button>
            </div>
            <div class="invite-stats">
                <div class="stat-item">
                    <div class="stat-value" id="inviteCount">0</div>
                    <div class="stat-label">Â∑≤ÈÇÄËØ∑</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="inviteReward">0</div>
                    <div class="stat-label">Â•ñÂä±Ê¨°Êï∞</div>
                </div>
            </div>
            <button class="close-modal-btn" onclick="closeInviteModal()">ÂÖ≥Èó≠</button>
        </div>
    </div>

    <!-- ÂºÄÂèëËÄÖÈù¢Êùø -->
    <div class="dev-modal" id="devModal">
        <div class="dev-modal-content">
            <div class="dev-modal-header">
                <h2>üõ†Ô∏è ÂºÄÂèëËÄÖÊ®°Âºè</h2>
                <p style="font-size: 14px; color: #666; margin-top: 8px;">Âø´ÈÄüÊµãËØïÊâÄÊúâÂäüËÉΩ</p>
            </div>
            
            <div class="dev-buttons">
                <button class="dev-action-btn grant" onclick="quickAddSpins()" style="background: linear-gradient(135deg, #ff6b6b, #ee5a6f); font-size: 18px; padding: 20px;">
                    üé≤ Âø´ÈÄüÊ∑ªÂä†1Ê¨°ÊäΩÂ•ñ
                    <span style="display: block; font-size: 12px; opacity: 0.9; margin-top: 4px;">
                        ÁÇπÂáªÁ´ãÂç≥Ëé∑Âæó1Ê¨°ÊäΩÂ•ñÊú∫‰ºö
                    </span>
                </button>
                
                <button class="dev-action-btn grant" onclick="grantTestAccess()">
                    ‚ö° Êéà‰∫àÊµãËØïÊùÉÈôê
                    <span style="display: block; font-size: 12px; opacity: 0.8; margin-top: 4px;">
                        ‰ΩôÈ¢ù150U + 10Ê¨°ÊäΩÂ•ñÊú∫‰ºö
                    </span>
                </button>
                
                <button class="dev-action-btn complete" onclick="completeAllTasks()">
                    ‚úÖ ÂÆåÊàêÊâÄÊúâ‰ªªÂä°
                    <span style="display: block; font-size: 12px; opacity: 0.8; margin-top: 4px;">
                        Ëá™Âä®ÂÆåÊàêÊâÄÊúâÂèØÁî®‰ªªÂä°
                    </span>
                </button>
                
                <button class="dev-action-btn reset" onclick="resetAccount()">
                    üîÑ ÈáçÁΩÆË¥¶Âè∑
                    <span style="display: block; font-size: 12px; opacity: 0.8; margin-top: 4px;">
                        ÊÅ¢Â§çÂà∞ÂàùÂßãÁä∂ÊÄÅ
                    </span>
                </button>
                
                <button class="dev-action-btn" onclick="syncSpins()" style="background: linear-gradient(135deg, #f093fb, #f5576c);">
                    üîß ‰øÆÂ§çÊäΩÂ•ñÊ¨°Êï∞
                    <span style="display: block; font-size: 12px; opacity: 0.8; margin-top: 4px;">
                        ÂêåÊ≠•Êï∞ÊçÆÂ∫ìÂíåÊòæÁ§∫‰∏ç‰∏ÄËá¥
                    </span>
                </button>
            </div>
            
            <div class="dev-info" id="devInfo">
                <div style="text-align: center; color: #999; padding: 20px;">
                    Âä†ËΩΩ‰∏≠...
                </div>
            </div>
            
            <button class="close-dev-modal-btn" onclick="closeDevModal()">ÂÖ≥Èó≠</button>
        </div>
    </div>

    <!-- ÊèêÁé∞ÊèêÁ§∫ÂºπÁ™ó -->
    <div class="result-modal" id="withdrawTipModal">
        <div class="result-content" style="max-width: 400px;">
            <div style="font-size: 60px; margin-bottom: 15px;">üí∞</div>
            <h2 style="font-size: 28px; margin-bottom: 15px; color: #FFD700;">ÊèêÁé∞ËØ¥Êòé</h2>
            <div style="background: linear-gradient(135deg, rgba(255, 215, 0, 0.2), rgba(255, 165, 0, 0.2)); padding: 25px; border-radius: 15px; margin: 20px 0; border: 2px solid rgba(255, 215, 0, 0.3);">
                <p style="font-size: 20px; font-weight: bold; color: #FFD700; margin: 0; line-height: 1.6; text-shadow: 0 2px 4px rgba(0,0,0,0.3);">
                    Á¥ØËÆ°Êª° <span style="font-size: 28px; color: #FFF;">‚Çπ10K</span><br>
                    Âç≥ÂèØÁ´ãÈ©¨ÊèêÁé∞Âà∞Ë¥¶ÔºÅ
                </p>
            </div>
            <div id="withdrawTipContent" style="font-size: 16px; color: rgba(255,255,255,0.9); margin: 20px 0; line-height: 1.8;">
                <!-- Âä®ÊÄÅÂÜÖÂÆπ -->
            </div>
            <button class="close-modal-btn" onclick="closeWithdrawTipModal()" style="margin-top: 10px;">Áü•ÈÅì‰∫Ü</button>
        </div>
    </div>

    <!-- ‰ªªÂä°ÂºπÁ™ó -->
    <div class="task-modal" id="taskModal">
        <div class="task-modal-content">
            <div class="task-modal-header">
                <h2>üìã ÂΩìÂâç‰ªªÂä°</h2>
                <p>ÂÆåÊàê‰ªªÂä°Ëé∑ÂæóÊäΩÂ•ñÊú∫‰ºö</p>
            </div>

            <div class="current-task-card" id="currentTaskCard">
                <div class="task-type-badge" id="taskTypeBadge">ÂàùÂßã‰ªªÂä°</div>
                <div class="task-name" id="taskName">ÂÆåÊàêÈ¶ñÊ¨°ÊäΩÂ•ñ</div>
                <div class="task-description" id="taskDescription">
                    ËøõË°å‰∏ÄÊ¨°‰ªòË¥πÊ∏∏Áé©Âπ∂ÂÆåÊàêÊäΩÂ•ñÔºåÂç≥ÂèØÊøÄÊ¥ªÂêéÁª≠‰ªªÂä°Á≥ªÁªü
                </div>
                <div class="task-progress-bar">
                    <div class="task-progress-fill" id="taskProgressFill" style="width: 0%;"></div>
                </div>
                <div class="task-progress-text" id="taskProgressText">ËøõÂ∫¶: 0 / 1</div>
                
                <div class="task-action-buttons" id="taskActionButtons">
                    <!-- Âä®ÊÄÅÁîüÊàêÊåâÈíÆ -->
                </div>
            </div>


            <button class="close-task-modal-btn" onclick="closeTaskModal()">ÂÖ≥Èó≠</button>
        </div>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.ready();
        tg.expand();

        const APP_VERSION = '1.2.0'; // ÁâàÊú¨Âè∑ÔºåÁî®‰∫éË∞ÉËØï
        console.log('üöÄ Â∫îÁî®ÁâàÊú¨:', APP_VERSION);
        console.log('üì± Telegram WebApp ÁâàÊú¨:', tg.version);
        
        const isDevelopment = !tg.initData;
        const API_BASE = window.location.origin + '/api';
        let authToken = localStorage.getItem('authToken') || 'dev-token';
        let isSpinning = false;

        // ÂÆâÂÖ®ÁöÑ Telegram API ÂåÖË£ÖÂáΩÊï∞
        function safeTgAlert(message) {
            try {
                if (typeof tg.showAlert === 'function') {
                    tg.showAlert(message);
                } else {
                    alert(message);
                }
            } catch (error) {
                console.error('showAlert Â§±Ë¥•:', error);
                alert(message);
            }
        }

        function safeTgConfirm(message, callback) {
            try {
                if (typeof tg.showConfirm === 'function') {
                    tg.showConfirm(message, callback);
                } else if (confirm(message)) {
                    callback(true);
                }
            } catch (error) {
                console.error('showConfirm Â§±Ë¥•:', error);
                if (confirm(message)) {
                    callback(true);
                }
            }
        }

        // ‰ªªÂä°Á≥ªÁªüÈÖçÁΩÆ - ÂêéÁ´ØÊéßÂà∂ÔºåÂâçÁ´ØÂè™ÊòæÁ§∫ÂΩìÂâç‰ªªÂä°
        const TASK_REWARDS = [
            9900,    // ‰ªªÂä°1ÔºöÈ¶ñÊ¨°Ê∏∏Áé©
            99,      // ‰ªªÂä°2ÔºöÈÇÄËØ∑Êàñ‰ªòË¥π
            0.5,     // ‰ªªÂä°3ÔºöÂøÖÈ°ª‰ªòË¥π
            0.4,     // ‰ªªÂä°4
            0.05,    // ‰ªªÂä°5
            0.04,    // ‰ªªÂä°6
            0.001,   // ‰ªªÂä°7ÔºöÂøÖÈ°ª‰ªòË¥π
            0.001,   // ‰ªªÂä°8
            0.001,   // ‰ªªÂä°9
            0.001,   // ‰ªªÂä°10
            0.001,   // ‰ªªÂä°11ÔºöÂøÖÈ°ª‰ªòË¥π
            0.001,   // ‰ªªÂä°12
            0.0005,  // ‰ªªÂä°13
            0.0005,  // ‰ªªÂä°14
            0.0005,  // ‰ªªÂä°15ÔºöÂøÖÈ°ª‰ªòË¥π
            0.0005,  // ‰ªªÂä°16
            0.0002,  // ‰ªªÂä°17
            0.0002,  // ‰ªªÂä°18
            0.0002,  // ‰ªªÂä°19ÔºöÂøÖÈ°ª‰ªòË¥π
            0.0002,  // ‰ªªÂä°20
            0.0001,  // ‰ªªÂä°21
            0.0001,  // ‰ªªÂä°22
            0.0005,  // ‰ªªÂä°23ÔºöÂøÖÈ°ª‰ªòË¥π
            0.0005   // ‰ªªÂä°24ÔºöÂøÖÈ°ª‰ªòË¥π
        ];

        // ‰ªªÂä°Á±ªÂûãÂÆö‰πâ
        const TASK_TYPES = {
            INITIAL_SPIN: 'initial_spin',      // ÂàùÂßãÊäΩÂ•ñ
            PAID_GAME: 'paid_game',            // ÂøÖÈ°ª‰ªòË¥πÊ∏∏Áé©
            INVITE_OR_GAME: 'invite_or_game'   // ÈÇÄËØ∑Â•ΩÂèãÊàñ‰ªòË¥πÊ∏∏Áé©
        };

        // Ê†ºÂºèÂåñÂ•ñÈáëÊòæÁ§∫ - ‰ΩøÁî®Âç∞Â∫¶Êï∞Â≠óÁ≥ªÁªü
        function formatPrizeAmount(amount) {
            // Á°Æ‰øùËΩ¨Êç¢‰∏∫Êï∞Â≠óÁ±ªÂûã
            const num = parseFloat(amount);
            if (isNaN(num)) {
                return '‚Çπ0';
            }
            
            if (num >= 10000000) {
                // Crore (ÂçÉ‰∏á)
                const crore = num / 10000000;
                return `‚Çπ${crore.toFixed(2).replace(/\.?0+$/, '')}Cr`;
            } else if (num >= 100000) {
                // Lakh (ÂçÅ‰∏á)
                const lakh = num / 100000;
                return `‚Çπ${lakh.toFixed(1).replace(/\.?0+$/, '')}L`;
            } else if (num >= 10000) {
                // Âè™Êúâ >= 10000 ÊâçÊòæÁ§∫‰∏∫KÊ†ºÂºè
                const thousand = num / 1000;
                return `‚Çπ${thousand.toFixed(1).replace(/\.?0+$/, '')}K`;
            } else if (num >= 1) {
                // 1-9999ÔºöÂè™Âú®Â∞èÊï∞‰∏ç‰∏∫0Êó∂ÊòæÁ§∫Â∞èÊï∞
                const hasDecimal = num % 1 !== 0;
                if (hasDecimal) {
                    // ÊúâÂ∞èÊï∞ÔºöÂéªÊéâÊú´Â∞æÁöÑ0
                    return `‚Çπ${num.toFixed(6).replace(/\.?0+$/, '')}`;
                } else {
                    // Êï¥Êï∞ÔºöÁõ¥Êé•ÊòæÁ§∫Ôºå‰ΩøÁî®Âç∞Â∫¶Êï∞Â≠óÊ†ºÂºè
                    return `‚Çπ${Math.floor(num).toLocaleString('en-IN')}`;
                }
            } else {
                // Â∞è‰∫é1ÁöÑÔºö‰øùÁïôÂ∞èÊï∞ÔºåÂéªÊéâÊú´Â∞æÁöÑ0
                return `‚Çπ${num.toFixed(6).replace(/\.?0+$/, '')}`;
            }
        }

        // ÊäΩÂ•ñÂäüËÉΩÔºàÂü∫‰∫é available_spinsÔºâ
        async function handleSpin() {
            if (isSpinning) return;

            const spinBtn = document.getElementById('spinBtn');
            const wheel = document.getElementById('wheel');
            const spinStatus = document.getElementById('spinStatus');

            try {
                isSpinning = true;
                spinBtn.disabled = true;
                spinStatus.textContent = 'Ê£ÄÊü•ÊäΩÂ•ñËµÑÊ†º...';

                // ÁôªÂΩï
                if (!authToken || authToken === 'dev-token') {
                    await login();
                }

                // Ê£ÄÊü•ÂèØÁî®ÊäΩÂ•ñÊ¨°Êï∞
                const availableResponse = await fetch(`${API_BASE}/spin/available`, {
                    headers: { 'Authorization': `Bearer ${authToken}` },
                });
                const availableData = await availableResponse.json();

                if (!availableData.success || availableData.data.available_spins <= 0) {
                    spinStatus.textContent = 'Ê≤°ÊúâÂèØÁî®ÁöÑÊäΩÂ•ñÊú∫‰ºöÔºÅ';
                    isSpinning = false;
                    spinBtn.disabled = false;
                    // ÊòæÁ§∫‰ªªÂä°ÂºπÁ™ó
                    showTaskModal();
                    return;
                }

                spinStatus.textContent = 'üé∞ ËΩ¨ÁõòÊóãËΩ¨‰∏≠...';

                // Ë∞ÉÁî®Êñ∞ÁöÑÊäΩÂ•ñAPIÔºàÂü∫‰∫é available_spinsÔºâ
                const spinResponse = await fetch(`${API_BASE}/spin/execute`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${authToken}`,
                        'Content-Type': 'application/json',
                    },
                });

                const spinData = await spinResponse.json();

                if (!spinData.success) {
                    throw new Error(spinData.message || 'ÊäΩÂ•ñÂ§±Ë¥•');
                }

                const result = spinData.data;
                const prizeAmount = result.prize_amount || result.amount || 88;

                // ËÆ°ÁÆóÊñπÂùóË∑≥Âä®Âä®ÁîªÔºàÊ†πÊçÆÂ•ñÈáëÈáëÈ¢ùÂåπÈÖçÊ†ºÂ≠êÔºâ
                // Ê†ºÂ≠êÈáëÈ¢ùÔºö8.88Cr, 88.8L, 18.8L, 8.8L, 1.8L, 80K, 30K, 10K, 9.9K, 7K, Random, 99
                const prizeMap = {
                    88880000: 0, 8880000: 1, 1880000: 2, 880000: 3, 180000: 4, 80000: 5, 
                    30000: 6, 10000: 7, 9900: 8, 7000: 9, 99: 11
                    // RandomÂ•ñÂä±‰ºöÂú®ÂêéÁ´ØÈöèÊú∫ÁîüÊàêÈáëÈ¢ùÔºåÊ†πÊçÆÂÆûÈôÖÈáëÈ¢ùÂåπÈÖçÂà∞ÂØπÂ∫îÊ†ºÂ≠êÔºåÂ¶ÇÊûúÊ≤°ÊúâÂåπÈÖçÂ∞±ÊòæÁ§∫Âú®Ê†ºÂ≠ê10
                };
                
                // ÂØπ‰∫éÈöèÊú∫Â•ñÂä±ÔºàÊ†ºÂ≠ê10ÔºâÔºåÂ¶ÇÊûúÈáëÈ¢ù‰∏çÂú®prizeMap‰∏≠ÔºåÂ∞±ÊòæÁ§∫Âú®Ëøô‰∏™Ê†ºÂ≠ê
                let targetSector = prizeMap[prizeAmount];
                if (targetSector === undefined) {
                    // Ê£ÄÊü•ÊòØÂê¶ÊòØÈöèÊú∫ÈáëÈ¢ùÔºà100-10000‰πãÈó¥ÁöÑ‰ªªÊÑèÂÄºÔºâ
                    if (prizeAmount > 99 && prizeAmount < 100000 && !prizeMap[prizeAmount]) {
                        targetSector = 10; // RandomÊ†ºÂ≠ê
                    } else {
                        targetSector = 7; // ÈªòËÆ§10KÊ†ºÂ≠ê
                    }
                }
                
                // ËÄÅËôéÊú∫Ë∑≥Âä®Âä®Áîª
                const sectors = wheel.querySelectorAll('.sector');
                let currentIndex = 0;
                let cycles = 0;
                const totalCycles = 3; // Ë∑≥Âä®3Âúà
                const speed = 80; // ÂàùÂßãÈÄüÂ∫¶(ms)
                
                const jump = () => {
                    // ÁßªÈô§‰πãÂâçÁöÑactive
                    sectors.forEach(s => s.classList.remove('active'));
                    
                    // Ê∑ªÂä†ÂΩìÂâçÁöÑactive
                    sectors[currentIndex].classList.add('active');
                    
                    // ËÆ°ÁÆó‰∏ã‰∏Ä‰∏™‰ΩçÁΩÆ
                    currentIndex = (currentIndex + 1) % 12;
                    
                    // ÂÆåÊàê‰∏ÄÂúà
                    if (currentIndex === 0) {
                        cycles++;
                    }
                    
                    // Âà§Êñ≠ÊòØÂê¶ÁªìÊùü
                    if (cycles < totalCycles || currentIndex <= targetSector) {
                        // ÈÄêÊ∏êÂáèÈÄü
                        const delay = cycles >= totalCycles ? speed + (currentIndex * 30) : speed;
                        setTimeout(jump, delay);
                    } else {
                        // Á°Æ‰øùÂÅúÂú®ÁõÆÊ†á‰ΩçÁΩÆ
                        sectors.forEach(s => s.classList.remove('active'));
                        sectors[targetSector].classList.add('active');
                    }
                };
                
                jump();

                // ÊòæÁ§∫ÁªìÊûú
                setTimeout(async () => {
                    const formattedAmount = formatPrizeAmount(prizeAmount);
                    spinStatus.textContent = `üéâ ÊÅ≠ÂñúËé∑Âæó ${formattedAmount} Âç¢ÊØîÔºÅ`;
                    
                    // ÊòæÁ§∫ÂºπÁ™ó
                    const message = result.requires_tasks 
                        ? `ÊÅ≠ÂñúËé∑Âæó ${formattedAmount} Âç¢ÊØîÔºÅÂÆåÊàê‰ªªÂä°ÂêéÂç≥ÂèØËß£ÈîÅÊèêÁé∞„ÄÇ`
                        : `ÊÅ≠ÂñúËé∑Âæó ${formattedAmount} Âç¢ÊØîÔºÅ`;
                    showResultModal(prizeAmount, message);
                    
                    isSpinning = false;
                    spinBtn.disabled = false;
                    
                    // Êõ¥Êñ∞ÊâÄÊúâÊòæÁ§∫
                    await loadAvailableSpins(); // ÊäΩÂ•ñÊ¨°Êï∞ÂáèÂ∞ë
                    await checkTaskProgress(); // Êõ¥Êñ∞ËÉΩÈáèÊù°
                }, 4000);

            } catch (error) {
                console.error('ÊäΩÂ•ñÈîôËØØ:', error);
                spinStatus.textContent = 'ÊäΩÂ•ñÂ§±Ë¥•ÔºåËØ∑ÈáçËØï';
                safeTgAlert('ÊäΩÂ•ñÂ§±Ë¥•: ' + error.message);
                isSpinning = false;
                spinBtn.disabled = false;
            }
        }

        // ÁôªÂΩï
        async function login() {
            try {
                console.log('=== ÁôªÂΩïË∞ÉËØï ===');
                console.log('isDevelopment:', isDevelopment);
                
                if (isDevelopment) {
                    console.log('‚ö†Ô∏è ÂºÄÂèëÊ®°ÂºèÔºöÊó†Ê≥ïÁôªÂΩïÔºà‰∏çÂú® Telegram ÁéØÂ¢ÉÔºâ');
                    authToken = 'dev-token';
                    return;
                }

                console.log('Ëé∑Âèñ Telegram initData...');
                const initData = tg.initData;
                
                if (!initData) {
                    console.error('‚ùå Ê≤°Êúâ initData');
                    throw new Error('Êó†Ê≥ïËé∑Âèñ Telegram Êï∞ÊçÆÔºåËØ∑Á°Æ‰øùÂú® Telegram ÂÜÖÊâìÂºÄÂ∫îÁî®');
                }
                
                console.log('initData ÈïøÂ∫¶:', initData.length);
                console.log('ÂèëÈÄÅÁôªÂΩïËØ∑Ê±ÇÂà∞:', `${API_BASE}/auth/login`);
                
                const response = await fetch(`${API_BASE}/auth/login`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ initData }),
                });
                
                console.log('ÁôªÂΩïÂìçÂ∫îÁä∂ÊÄÅ:', response.status);
                
                if (!response.ok) {
                    console.error('‚ùå ÁôªÂΩïËØ∑Ê±ÇÂ§±Ë¥•ÔºåÁä∂ÊÄÅÁ†Å:', response.status);
                    throw new Error(`ÁôªÂΩïËØ∑Ê±ÇÂ§±Ë¥• (${response.status})`);
                }
                
                const data = await response.json();
                console.log('ÁôªÂΩïÂìçÂ∫îÊï∞ÊçÆ:', data);
                
                if (data.success && data.data && data.data.token) {
                    authToken = data.data.token;
                    localStorage.setItem('authToken', authToken);
                    console.log('‚úÖ ÁôªÂΩïÊàêÂäüÔºåtokenÂ∑≤‰øùÂ≠ò');
                    
                    // Ê£ÄÊü•ÂºÄÂèëËÄÖÊùÉÈôê
                    await checkDevAccess();
                } else {
                    console.error('‚ùå ÁôªÂΩïÂ§±Ë¥•:', data.error || data.message);
                    throw new Error(data.error || data.message || 'ÁôªÂΩïÂ§±Ë¥•ÔºåÊú™ËøîÂõûÊúâÊïàtoken');
                }
            } catch (error) {
                console.error('‚ùå ÁôªÂΩïÈîôËØØ:', error);
                // Ê∏ÖÈô§ÂèØËÉΩÂ≠òÂú®ÁöÑÊó†Êïàtoken
                authToken = null;
                localStorage.removeItem('authToken');
                throw error;
            }
        }

        // Ê£ÄÊü•‰ªªÂä°ËøõÂ∫¶Âπ∂Êõ¥Êñ∞ËÉΩÈáèÊù°
        async function checkTaskProgress() {
            try {
                if (!authToken || authToken === 'dev-token') {
                    console.log('‚ö†Ô∏è Êú™ÁôªÂΩïÔºåÂÖàÁôªÂΩï');
                    await login();
                }

                console.log('üì° Ëé∑ÂèñÁî®Êà∑‰ΩôÈ¢ù...');
                // Ëé∑ÂèñÁî®Êà∑‰ΩôÈ¢ù
                const balanceResponse = await fetch(`${API_BASE}/user/balance`, {
                    headers: { 'Authorization': `Bearer ${authToken}` }
                });
                
                console.log('üìä ‰ΩôÈ¢ùAPIÂìçÂ∫îÁä∂ÊÄÅ:', balanceResponse.status);
                
                if (balanceResponse.ok) {
                    const balanceData = await balanceResponse.json();
                    console.log('üìä ‰ΩôÈ¢ùAPIÂìçÂ∫îÊï∞ÊçÆ:', balanceData);
                    
                    if (balanceData.success) {
                        // ÂêéÁ´ØËøîÂõûÁöÑÊòØÈ©ºÂ≥∞ÂºèÔºölockedBalance
                        const balance = balanceData.data.lockedBalance || balanceData.data.locked_balance || 0;
                        console.log('üíµ Ëß£ÊûêÂà∞ÁöÑ‰ΩôÈ¢ù:', balance);
                        updateEnergyBar(balance);
                    } else {
                        console.error('‚ùå ‰ΩôÈ¢ùAPIËøîÂõûfalse:', balanceData);
                    }
                } else {
                    console.error('‚ùå ‰ΩôÈ¢ùAPIËØ∑Ê±ÇÂ§±Ë¥•:', balanceResponse.status);
                }
            } catch (error) {
                console.error('‚ùå Ê£ÄÊü•‰ªªÂä°ËøõÂ∫¶ÈîôËØØ:', error);
            }
        }

        // Êõ¥Êñ∞‰ΩôÈ¢ùÊòæÁ§∫
        function updateEnergyBar(balance) {
            console.log('üí∞ Êõ¥Êñ∞‰ΩôÈ¢ùÊòæÁ§∫:', balance);
            
            // Êõ¥Êñ∞ÊèêÁé∞ÊåâÈíÆÂå∫ÂüüÁöÑ‰ΩôÈ¢ùÊòæÁ§∫
            const withdrawBalance = document.getElementById('withdrawBalance');
            if (withdrawBalance) {
                const formattedBalance = formatPrizeAmount(balance);
                withdrawBalance.textContent = formattedBalance;
                console.log('‚úÖ ‰ΩôÈ¢ùÂ∑≤Êõ¥Êñ∞Âà∞È°µÈù¢:', formattedBalance);
            } else {
                console.error('‚ùå Êâæ‰∏çÂà∞ withdrawBalance ÂÖÉÁ¥†');
            }
            
            // ‰øùÂ≠òÂΩìÂâç‰ΩôÈ¢ùÂà∞ÂÖ®Â±ÄÂèòÈáè
            window.currentBalance = balance;
        }

        // Â§ÑÁêÜÊèêÁé∞ÊåâÈíÆÁÇπÂáª
        async function handleWithdraw() {
            const threshold = 10000;
            const balance = window.currentBalance || 0;
            
            if (balance < threshold) {
                const remaining = threshold - balance;
                showWithdrawTipModal(balance, remaining);
                return;
            }
            
            // ‰ΩôÈ¢ùË∂≥Â§üÔºåÊòæÁ§∫‰ªªÂä°ÂºπÁ™ó
            showTaskModal();
        }

        // ÊòæÁ§∫ÊèêÁé∞ÊèêÁ§∫ÂºπÁ™ó
        function showWithdrawTipModal(currentBalance, remaining) {
            const modal = document.getElementById('withdrawTipModal');
            const content = document.getElementById('withdrawTipContent');
            
            content.innerHTML = `
                <div style="background: rgba(255, 107, 107, 0.2); padding: 15px; border-radius: 10px; border: 1px solid rgba(255, 107, 107, 0.3); margin-bottom: 15px;">
                    <p style="margin: 0; font-size: 14px; opacity: 0.8;">ÂΩìÂâçÂ•ñÈáë</p>
                    <p style="margin: 5px 0 0 0; font-size: 24px; font-weight: bold; color: #FFD700;">${formatPrizeAmount(currentBalance)}</p>
                </div>
                <p style="margin: 0; font-size: 16px; opacity: 0.9;">
                    üí™ ËøòÈúÄËé∑Âæó <span style="color: #FFD700; font-weight: bold; font-size: 18px;">${formatPrizeAmount(remaining)}</span> Âç≥ÂèØÊèêÁé∞ÔºÅ
                </p>
                <p style="margin: 15px 0 0 0; font-size: 14px; opacity: 0.7;">
                    üí° ÁªßÁª≠ÂÆåÊàê‰ªªÂä°ÂíåÈÇÄËØ∑Â•ΩÂèãÊù•Â¢ûÂä†Â•ñÈáëÂêß
                </p>
            `;
            
            modal.classList.add('show');
        }

        // ÂÖ≥Èó≠ÊèêÁé∞ÊèêÁ§∫ÂºπÁ™ó
        function closeWithdrawTipModal() {
            const modal = document.getElementById('withdrawTipModal');
            modal.classList.remove('show');
        }

        // ÊòæÁ§∫ÊèêÁé∞ÂºπÁ™ó
        function showWithdrawModal() {
            alert('ÊèêÁé∞ÂäüËÉΩÂç≥Â∞ÜÂºÄÊîæÔºÅ\n\nËØ∑ÂáÜÂ§áÂ•Ω‰ª•‰∏ã‰ø°ÊÅØÔºö\n- Èì∂Ë°åÂç°Âè∑\n- ËÅîÁ≥ªÁîµËØù\n\nÊàë‰ª¨‰ºöÂú®ÂÆ°Ê†∏Âêé24Â∞èÊó∂ÂÜÖÂÆåÊàêËΩ¨Ë¥¶„ÄÇ');
        }

        // ÊòæÁ§∫‰ªªÂä°ÂºπÁ™ó
        async function showTaskModal() {
            const modal = document.getElementById('taskModal');
            if (modal) {
                modal.classList.add('show');
                // Âä†ËΩΩÂΩìÂâç‰ªªÂä°
                await loadCurrentTask();
            }
        }

        // ÂÖ≥Èó≠‰ªªÂä°ÂºπÁ™ó
        function closeTaskModal() {
            const modal = document.getElementById('taskModal');
            modal.classList.remove('show');
        }

        // Âä†ËΩΩÂΩìÂâç‰ªªÂä°
        async function loadCurrentTask() {
            try {
                if (!authToken || authToken === 'dev-token') {
                    await login();
                }

                // Ëé∑ÂèñÁî®Êà∑‰ªªÂä°ËøõÂ∫¶
                const response = await fetch(`${API_BASE}/task/current`, {
                    headers: { 'Authorization': `Bearer ${authToken}` }
                });

                if (response.ok) {
                    const data = await response.json();
                    if (data.success) {
                        updateTaskUI(data.data);
                    }
                } else {
                    // Â¶ÇÊûúAPI‰∏çÂ≠òÂú®ÔºåÊòæÁ§∫ÈªòËÆ§‰ªªÂä°
                    updateTaskUI({
                        task_index: 0,
                        task_type: TASK_TYPES.INITIAL_SPIN,
                        progress: 0,
                        required: 1,
                        total_progress: 0,
                        completed_tasks: 0
                    });
                }
            } catch (error) {
                console.error('Âä†ËΩΩ‰ªªÂä°ÈîôËØØ:', error);
                // ÊòæÁ§∫ÈªòËÆ§‰ªªÂä°
                updateTaskUI({
                    task_index: 0,
                    task_type: TASK_TYPES.INITIAL_SPIN,
                    progress: 0,
                    required: 1,
                    total_progress: 0,
                    completed_tasks: 0
                });
            }
        }

        // Êõ¥Êñ∞‰ªªÂä°UI
        function updateTaskUI(taskData) {
            const taskTypeBadge = document.getElementById('taskTypeBadge');
            const taskName = document.getElementById('taskName');
            const taskDescription = document.getElementById('taskDescription');
            const taskProgressFill = document.getElementById('taskProgressFill');
            const taskProgressText = document.getElementById('taskProgressText');
            const taskActionButtons = document.getElementById('taskActionButtons');

            const { task_index, task_type, progress, required, total_progress, completed_tasks } = taskData;

            // Ëé∑ÂèñÂΩìÂâç‰ªªÂä°Â•ñÂä±ÈáëÈ¢ù
            const rewardAmount = TASK_REWARDS[task_index] || 0;
            // Áõ¥Êé•ÊòæÁ§∫ÂáÜÁ°ÆÊï∞Â≠óÔºå‰∏ç‰ΩøÁî®Ê†ºÂºèÂåñÔºàÈÅøÂÖç9900ÂèòÊàê9.9KÔºâ
            const formattedReward = rewardAmount >= 1000 ? `‚Çπ${rewardAmount.toLocaleString('en-IN')}` : `‚Çπ${rewardAmount}`;

            // Êõ¥Êñ∞ËøõÂ∫¶Êù°
            const progressPercent = (progress / required) * 100;
            taskProgressFill.style.width = progressPercent + '%';
            taskProgressText.textContent = `ËøõÂ∫¶: ${progress} / ${required}`;

            // ‰ªªÂä°Â∫èÂè∑Ôºà‰ªé1ÂºÄÂßãÔºâ
            const taskNumber = task_index + 1;

            // Ê†πÊçÆ‰ªªÂä°Á±ªÂûãÊòæÁ§∫‰∏çÂêåÂÜÖÂÆπ
            if (task_type === TASK_TYPES.INITIAL_SPIN) {
                // ‰ªªÂä°1: È¶ñÊ¨°Ê∏∏Áé©
                taskTypeBadge.className = 'task-type-badge initial';
                taskTypeBadge.textContent = 'üé∞ ÂàùÂßã‰ªªÂä°';
                taskName.textContent = `‰ªªÂä°${taskNumber}ÔºöÂÆåÊàêÈ¶ñÊ¨°Ê∏∏Áé©`;
                taskDescription.innerHTML = `ËøõÂÖ•Ê∏∏ÊàèÁé©‰∏ÄÊääÂç≥ÂèØËé∑ÂæóÊäΩÂ•ñÊú∫‰ºö`;
                
                taskActionButtons.innerHTML = `
                    <button class="task-action-btn primary" onclick="closeTaskModal(); scrollToGameModes();">
                        üéÆ ÂéªÊ∏∏Áé©
                    </button>
                `;
            } else if (task_type === TASK_TYPES.PAID_GAME) {
                // ÂøÖÈ°ª‰ªòË¥πÊ∏∏Áé©‰ªªÂä°
                taskTypeBadge.className = 'task-type-badge';
                taskTypeBadge.textContent = 'üíé ÂøÖÂÅö‰ªªÂä°';
                taskName.textContent = `‰ªªÂä°${taskNumber}Ôºö‰ªòË¥πÊ∏∏Áé©`;
                taskDescription.innerHTML = `ÂÆåÊàê‰∏ÄÊ¨°‰ªòË¥πÊ∏∏Áé©Ëé∑ÂæóÊäΩÂ•ñÊú∫‰ºö<br><span style="color: #ff6b6b;">‚ö†Ô∏è Ê≠§‰ªªÂä°ÂøÖÈ°ªÂÆåÊàêÊâçËÉΩÁªßÁª≠</span>`;
                
                taskActionButtons.innerHTML = `
                    <button class="task-action-btn primary" onclick="closeTaskModal(); scrollToGameModes();">
                        üí∞ ÂéªÊ∏∏Áé©
                    </button>
                `;
            } else if (task_type === TASK_TYPES.INVITE_OR_GAME) {
                // ÈÇÄËØ∑Êàñ‰ªòË¥π‰ªªÂä°
                taskTypeBadge.className = 'task-type-badge optional';
                taskTypeBadge.textContent = '‚ú® ÂèØÈÄâ‰ªªÂä°';
                taskName.textContent = `‰ªªÂä°${taskNumber}ÔºöÈÇÄËØ∑Â•ΩÂèãÊàñ‰ªòË¥πÊ∏∏Áé©`;
                taskDescription.innerHTML = `ÈÄâÊã©‰ªªÊÑè‰∏ÄÁßçÊñπÂºèÂÆåÊàê‰ªªÂä°Ôºö<br>‚Ä¢ ÈÇÄËØ∑1‰ΩçÊñ∞Â•ΩÂèã<br>‚Ä¢ ÂÆåÊàê‰∏ÄÊ¨°‰ªòË¥πÊ∏∏Áé©`;
                
                taskActionButtons.innerHTML = `
                    <button class="task-action-btn" onclick="closeTaskModal(); showInviteLink();">
                        üë• ÈÇÄËØ∑Â•ΩÂèã
                    </button>
                    <button class="task-action-btn" onclick="closeTaskModal(); scrollToGameModes();">
                        üíé ‰ªòË¥πÊ∏∏Áé©
                    </button>
                `;
            }
        }

        // ÊªöÂä®Âà∞ÊäΩÂ•ñÂå∫Âüü
        function scrollToSpin() {
            const spinSection = document.querySelector('.spin-hero');
            if (spinSection) {
                spinSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
        }

        // ÊªöÂä®Âà∞Ê∏∏ÊàèÊ®°ÂºèÂå∫Âüü
        function scrollToGameModes() {
            const modesSection = document.querySelector('.modes-container');
            if (modesSection) {
                modesSection.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }
        }

        // ÊòæÁ§∫ÁªìÊûúÂºπÁ™ó
        function showResultModal(amount, message) {
            const modal = document.getElementById('resultModal');
            const prizeAmount = document.getElementById('prizeAmount');
            const prizeMessage = document.getElementById('prizeMessage');
            
            const formattedAmount = formatPrizeAmount(amount);
            prizeAmount.textContent = formattedAmount.replace('‚Çπ', '') + ' Âç¢ÊØî';
            prizeMessage.innerHTML = message + '<br>ÂÆåÊàê‰ªªÂä°Âç≥ÂèØÊèêÁé∞ÔºÅ';
            modal.classList.add('show');
        }

        // ÂÖ≥Èó≠ÁªìÊûúÂºπÁ™ó
        function closeResultModal() {
            const modal = document.getElementById('resultModal');
            modal.classList.remove('show');
        }

        // ÈÇÄËØ∑ËΩÆËØ¢Áõ∏ÂÖ≥ÂèòÈáè
        let invitePollingInterval = null;
        let lastInviteCount = 0;
        let lastSpinCount = 0;

        // ÂêØÂä®ÈÇÄËØ∑ÁªüËÆ°ËΩÆËØ¢
        function startInvitePolling() {
            // Ê∏ÖÈô§ÊóßÁöÑËΩÆËØ¢
            if (invitePollingInterval) {
                clearInterval(invitePollingInterval);
            }
            
            // Á´ãÂç≥Ê£ÄÊü•‰∏ÄÊ¨°
            checkInviteUpdates();
            
            // ÊØè10ÁßíÊ£ÄÊü•‰∏ÄÊ¨°
            invitePollingInterval = setInterval(() => {
                checkInviteUpdates();
            }, 10000);
            
            console.log('‚úÖ ÈÇÄËØ∑ËΩÆËØ¢Â∑≤ÂêØÂä®ÔºåÊØè10ÁßíÊ£ÄÊü•‰∏ÄÊ¨°');
        }

        // Ê£ÄÊü•ÈÇÄËØ∑Êõ¥Êñ∞
        async function checkInviteUpdates() {
            try {
                if (!authToken || authToken === 'dev-token') {
                    return;
                }

                // Ëé∑ÂèñÈÇÄËØ∑ÁªüËÆ°
                const response = await fetch(`${API_BASE}/invite/info`, {
                    headers: { 'Authorization': `Bearer ${authToken}` }
                });

                if (response.ok) {
                    const data = await response.json();
                    if (data.success) {
                        const currentInviteCount = data.data.total_invites || 0;
                        
                        // Ê£ÄÊü•ÊòØÂê¶ÊúâÊñ∞ÈÇÄËØ∑
                        if (lastInviteCount > 0 && currentInviteCount > lastInviteCount) {
                            const newInvites = currentInviteCount - lastInviteCount;
                            console.log(`üéâ Ê£ÄÊµãÂà∞ ${newInvites} ‰∏™Êñ∞ÈÇÄËØ∑ÔºÅ`);
                            
                            // ÊòæÁ§∫ÂºπÁ™óÈÄöÁü•
                            if (window.Telegram?.WebApp) {
                                window.Telegram.WebApp.showPopup({
                                    message: `üéâ ÊÅ≠Âñú‰Ω†ÔºÅ\n\nÊúâ ${newInvites} ‰ΩçÂ•ΩÂèãÈÄöËøá‰Ω†ÁöÑÈÇÄËØ∑ÈìæÊé•Âä†ÂÖ•ÔºÅ\n\n‰Ω†Ëé∑Âæó‰∫Ü ${newInvites} Ê¨°ÊäΩÂ•ñÊú∫‰ºöÔºÅ`,
                                    buttons: [{type: 'ok', text: 'Â§™Ê£í‰∫ÜÔºÅ'}]
                                });
                            } else {
                                alert(`üéâ ÊÅ≠Âñú‰Ω†ÔºÅ\n\nÊúâ ${newInvites} ‰ΩçÂ•ΩÂèãÈÄöËøá‰Ω†ÁöÑÈÇÄËØ∑ÈìæÊé•Âä†ÂÖ•ÔºÅ\n\n‰Ω†Ëé∑Âæó‰∫Ü ${newInvites} Ê¨°ÊäΩÂ•ñÊú∫‰ºöÔºÅ`);
                            }
                            
                            // Âà∑Êñ∞ÊäΩÂ•ñÊ¨°Êï∞
                            await loadAvailableSpins();
                            
                            // Âà∑Êñ∞‰ΩôÈ¢ù
                            await checkTaskProgress();
                        }
                        
                        // Êõ¥Êñ∞ËÆ∞ÂΩïÁöÑÈÇÄËØ∑Êï∞
                        lastInviteCount = currentInviteCount;
                        
                        // Êõ¥Êñ∞È°µÈù¢ÊòæÁ§∫ÁöÑÈÇÄËØ∑Êï∞
                        const inviteCountEl = document.getElementById('inviteCount');
                        if (inviteCountEl) {
                            inviteCountEl.textContent = currentInviteCount;
                        }
                    }
                }
            } catch (error) {
                console.error('‚ö†Ô∏è Ê£ÄÊü•ÈÇÄËØ∑Êõ¥Êñ∞Â§±Ë¥•:', error);
            }
        }

        // ÊòæÁ§∫ÈÇÄËØ∑ÈìæÊé•
        async function showInviteLink() {
            console.log('üîî showInviteLink() ÂáΩÊï∞Ë¢´Ë∞ÉÁî®');
            
            // Á´ãÂç≥Ê£ÄÊü•ÈÇÄËØ∑Êõ¥Êñ∞
            await checkInviteUpdates();
            
            const modal = document.getElementById('inviteModal');
            const inviteLinkInput = document.getElementById('inviteLink');
            const inviteCountEl = document.getElementById('inviteCount');
            const inviteRewardEl = document.getElementById('inviteReward');

            try {
                console.log('=== ÈÇÄËØ∑ÂäüËÉΩË∞ÉËØï ===');
                console.log('isDevelopment:', isDevelopment);
                console.log('tg.initData:', tg.initData ? 'Â≠òÂú®' : '‰∏çÂ≠òÂú®');
                console.log('authToken:', authToken);
                console.log('Modal element:', modal ? 'ÊâæÂà∞' : 'Êú™ÊâæÂà∞');

                // Ê£ÄÊü•ÊòØÂê¶Âú® Telegram ÁéØÂ¢É‰∏≠
                if (isDevelopment) {
                    alert('‚ö†Ô∏è ËØ∑Âú® Telegram ÂÜÖÊâìÂºÄÂ∫îÁî®\n\nÂΩìÂâçÂú®ÊµèËßàÂô®‰∏≠ÊâìÂºÄÔºåÊó†Ê≥ï‰ΩøÁî®ÈÇÄËØ∑ÂäüËÉΩ„ÄÇ\n\nÊ≠£Á°ÆÊ≠•È™§Ôºö\n1. ÊâìÂºÄ Telegram Â∫îÁî®\n2. ÊêúÁ¥¢ @summondargon_bot\n3. ÁÇπÂáªËèúÂçïÊåâÈíÆ\n4. Âú® Telegram ÂÜÖÊâìÂºÄÂ∫îÁî®');
                    return;
                }

                // Â∞ùËØïÁôªÂΩïÔºàÂ¶ÇÊûúËøòÊ≤°ÊúâÊúâÊïàÁöÑ tokenÔºâ
                if (!authToken || authToken === 'dev-token') {
                    console.log('ÈúÄË¶ÅÁôªÂΩïÔºåÂºÄÂßãÁôªÂΩïÊµÅÁ®ã...');
                    try {
                        await login();
                        console.log('ÁôªÂΩïÂÆåÊàêÔºåtoken:', authToken ? 'Â∑≤ËÆæÁΩÆ' : 'Êú™ËÆæÁΩÆ');
                    } catch (loginError) {
                        console.error('ÁôªÂΩïÂ§±Ë¥•:', loginError);
                        safeTgAlert('ÁôªÂΩïÂ§±Ë¥•ÔºåËØ∑ÈáçÊñ∞ÊâìÂºÄÂ∫îÁî®ÂÜçËØï');
                        return;
                    }
                }

                console.log('ÂºÄÂßãËé∑ÂèñÈÇÄËØ∑‰ø°ÊÅØ...');
                
                // Ëé∑ÂèñÈÇÄËØ∑‰ø°ÊÅØ
                const response = await fetch(`${API_BASE}/invite/info`, {
                    headers: { 'Authorization': `Bearer ${authToken}` }
                });
                
                console.log('APIÂìçÂ∫îÁä∂ÊÄÅ:', response.status);
                
                if (!response.ok) {
                    if (response.status === 401) {
                        // Ê∏ÖÈô§Êó†ÊïàÁöÑ tokenÔºåÂ∞ùËØïÈáçÊñ∞ÁôªÂΩï
                        console.log('TokenÊó†ÊïàÔºåÊ∏ÖÈô§Âπ∂ÈáçÊñ∞ÁôªÂΩï...');
                        authToken = null;
                        localStorage.removeItem('authToken');
                        
                        try {
                            await login();
                            // ÈáçÊñ∞Â∞ùËØïËé∑ÂèñÈÇÄËØ∑‰ø°ÊÅØ
                            return await showInviteLink();
                        } catch (retryError) {
                            console.error('ÈáçÊñ∞ÁôªÂΩïÂ§±Ë¥•:', retryError);
                            safeTgAlert('Ë∫´‰ªΩÈ™åËØÅÂ§±Ë¥•ÔºåËØ∑ÂÖ≥Èó≠Â∫îÁî®ÂêéÈáçÊñ∞ÊâìÂºÄÂÜçËØï');
                            return;
                        }
                    }
                    throw new Error(`ÊúçÂä°Âô®ÈîôËØØ: ${response.status}`);
                }
                
                const data = await response.json();
                console.log('APIÂìçÂ∫îÊï∞ÊçÆ:', data);
                
                if (data.success) {
                    const inviteCode = data.data.invite_code;
                    
                    // ‰ΩøÁî® Telegram Web App ÈìæÊé• + startapp ÂèÇÊï∞ÔºàÊØèÊ¨°ÁÇπÂáªÈÉΩËÉΩ‰º†ÈÄíÂèÇÊï∞Ôºâ
                    const botUsername = 'summondargon_bot';
                    const webAppShortName = 'dragongame';
                    const inviteLink = `https://t.me/${botUsername}/${webAppShortName}?startapp=${inviteCode}`;
                    
                    inviteLinkInput.value = inviteLink;
                    inviteCountEl.textContent = data.data.total_invites || 0;
                    inviteRewardEl.textContent = data.data.invite_rewards || 0;
                    
                    modal.classList.add('show');
                    console.log('‚úÖ ÈÇÄËØ∑ÂºπÁ™óÂ∑≤ÊòæÁ§∫');
                    
                    // Âà∑Êñ∞ÂèØÊäΩÂ•ñÊ¨°Êï∞ÔºàÂèØËÉΩÊúâÊñ∞ÁöÑÈÇÄËØ∑Ôºâ
                    await loadAvailableSpins();
                } else {
                    throw new Error(data.error || 'Ëé∑ÂèñÈÇÄËØ∑‰ø°ÊÅØÂ§±Ë¥•');
                }
            } catch (error) {
                console.error('‚ùå ÈÇÄËØ∑ÈìæÊé•ÈîôËØØ:', error);
                safeTgAlert('Ëé∑ÂèñÈÇÄËØ∑ÈìæÊé•Â§±Ë¥•ÔºåËØ∑Á®çÂêéÂÜçËØï\n\nÈîôËØØ: ' + error.message);
            }
        }

        // Â§çÂà∂ÈÇÄËØ∑ÈìæÊé•
        async function copyInviteLink() {
            const inviteLinkInput = document.getElementById('inviteLink');
            const copyBtn = event.currentTarget;
            
            try {
                // Â∞ùËØï‰ΩøÁî®Áé∞‰ª£API
                if (navigator.clipboard && navigator.clipboard.writeText) {
                    await navigator.clipboard.writeText(inviteLinkInput.value);
                } else {
                    // ÈôçÁ∫ßÊñπÊ°à
                    inviteLinkInput.select();
                    document.execCommand('copy');
                }
                
                // ËßÜËßâÂèçÈ¶à
                copyBtn.classList.add('copied');
                copyBtn.textContent = '‚úÖ Â∑≤Â§çÂà∂';
                
                // TelegramÂàÜ‰∫´
                if (tg.openTelegramLink) {
                    const shareText = encodeURIComponent('üê≤ ‰∏ÄËµ∑Êù•Áé©Âè¨Âî§Á•ûÈæôÊ∏∏ÊàèÔºåËµ¢ÂèñÂ§ßÂ•ñÔºÅ');
                    tg.openTelegramLink(`https://t.me/share/url?url=${encodeURIComponent(inviteLinkInput.value)}&text=${shareText}`);
                }
                
                setTimeout(() => {
                    copyBtn.classList.remove('copied');
                    copyBtn.textContent = 'üìã Â§çÂà∂';
                }, 2000);
                
            } catch (error) {
                console.error('Â§çÂà∂Â§±Ë¥•:', error);
                alert('Â§çÂà∂Â§±Ë¥•ÔºåËØ∑ÊâãÂä®Â§çÂà∂ÈìæÊé•');
            }
        }

        // ÂÖ≥Èó≠ÈÇÄËØ∑ÂºπÁ™ó
        function closeInviteModal() {
            const modal = document.getElementById('inviteModal');
            modal.classList.remove('show');
        }

        // ÂºÄÂèëËÄÖÊ®°ÂºèÂáΩÊï∞
        let isDevMode = false;

        // Ê£ÄÊü•ÂºÄÂèëËÄÖÊùÉÈôê
        async function checkDevAccess() {
            try {
                console.log('üîç Ê£ÄÊü•ÂºÄÂèëËÄÖÊùÉÈôê...');
                
                const response = await fetch(`${API_BASE}/dev/info`, {
                    headers: { 'Authorization': `Bearer ${authToken}` }
                });
                
                console.log('ÂºÄÂèëËÄÖÊùÉÈôêÊ£ÄÊü•ÂìçÂ∫î:', response.status);
                
                if (response.ok) {
                    const data = await response.json();
                    console.log('ÂºÄÂèëËÄÖÊùÉÈôêÊï∞ÊçÆ:', data);
                    
                    if (data.success && data.data.isDev) {
                        isDevMode = true;
                        const devBtn = document.getElementById('devBtn');
                        if (devBtn) {
                            devBtn.style.display = 'inline-block';
                            console.log('üõ†Ô∏è ÂºÄÂèëËÄÖÊ®°ÂºèÂ∑≤ÂêØÁî®');
                        } else {
                            console.error('‚ùå Êâæ‰∏çÂà∞ devBtn ÂÖÉÁ¥†');
                        }
                    } else {
                        console.log('ÈùûÂºÄÂèëËÄÖÁî®Êà∑');
                    }
                } else {
                    console.log('ÂºÄÂèëËÄÖÊùÉÈôêÊ£ÄÊü•Â§±Ë¥•:', response.status);
                }
            } catch (error) {
                console.error('Ê£ÄÊü•ÂºÄÂèëËÄÖÊùÉÈôêÂá∫Èîô:', error);
            }
        }

        // ÂàáÊç¢ÂºÄÂèëËÄÖÈù¢Êùø
        async function toggleDevPanel() {
            const modal = document.getElementById('devModal');
            modal.classList.add('show');
            
            // Âä†ËΩΩÂΩìÂâçÁä∂ÊÄÅ
            try {
                const response = await fetch(`${API_BASE}/user/profile`, {
                    headers: { 'Authorization': `Bearer ${authToken}` }
                });
                
                if (response.ok) {
                    const data = await response.json();
                    const user = data.data.user;
                    
                    // Ëé∑ÂèñÂèØÁî®ÊäΩÂ•ñÊ¨°Êï∞
                    const spinsResponse = await fetch(`${API_BASE}/spin/available`, {
                        headers: { 'Authorization': `Bearer ${authToken}` }
                    });
                    let availableSpins = 0;
                    if (spinsResponse.ok) {
                        const spinsData = await spinsResponse.json();
                        availableSpins = spinsData.data?.available_spins || 0;
                    }
                    
                    document.getElementById('devInfo').innerHTML = `
                        <div style="font-size: 13px; line-height: 1.8;">
                            <div><strong>ÂΩìÂâçÁä∂ÊÄÅÔºö</strong></div>
                            <div>üí∞ ‰ΩôÈ¢ù: ‚Çπ${user.gameBalance || 0}</div>
                            <div>üé≤ Â∑≤ÂÆåÊàêÊäΩÂ•ñ: ${data.data.stats?.total_spins || 0}</div>
                            <div>üéØ ÂèØÊäΩÂ•ñÊ¨°Êï∞: ${availableSpins}</div>
                            <div>üë• ÈÇÄËØ∑‰∫∫Êï∞: ${user.totalInvites || 0} (ÊúâÊïà: ${user.validInvites || 0})</div>
                            <div>‚úÖ ÊèêÁé∞ËµÑÊ†º: ${user.withdrawalEligible ? 'Â∑≤Ëß£ÈîÅ' : 'Êú™Ëß£ÈîÅ'}</div>
                        </div>
                    `;
                }
            } catch (error) {
                console.error('Âä†ËΩΩÁä∂ÊÄÅÂ§±Ë¥•:', error);
            }
        }

        // ÂÖ≥Èó≠ÂºÄÂèëËÄÖÈù¢Êùø
        function closeDevModal() {
            const modal = document.getElementById('devModal');
            modal.classList.remove('show');
        }

        // Âø´ÈÄüÊ∑ªÂä†ÊäΩÂ•ñÊ¨°Êï∞ÔºàÊúÄÁÆÄÂçïÁõ¥Êé•Ôºâ
        async function quickAddSpins() {
            try {
                const response = await fetch(`${API_BASE}/dev/add-spins`, {
                    method: 'POST',
                    headers: { 
                        'Authorization': `Bearer ${authToken}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ count: 1 })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    await loadAvailableSpins(); // Âà∑Êñ∞ÊòæÁ§∫
                    await toggleDevPanel(); // Âà∑Êñ∞ÂºÄÂèëËÄÖÈù¢Êùø
                    safeTgAlert(`‚úÖ ${data.message}\n\nÂΩìÂâçÊÄªÊ¨°Êï∞: ${data.data.total}`);
                } else {
                    safeTgAlert('Êìç‰ΩúÂ§±Ë¥•: ' + data.error);
                }
            } catch (error) {
                console.error('Ê∑ªÂä†ÊäΩÂ•ñÊ¨°Êï∞Â§±Ë¥•:', error);
                safeTgAlert('Êìç‰ΩúÂ§±Ë¥•: ' + error.message);
            }
        }

        // Êéà‰∫àÊµãËØïÊùÉÈôê
        async function grantTestAccess() {
            if (!confirm('Á°ÆÂÆöË¶ÅÊéà‰∫àÊµãËØïÊùÉÈôêÂêóÔºü\n\nÂ∞Ü‰ºöËÆæÁΩÆÔºö\n- ‰ΩôÈ¢ù 150U\n- 10Ê¨°ÊäΩÂ•ñËÆ∞ÂΩï\n- 3‰∏™ÈÇÄËØ∑Â•ΩÂèã\n- Ëß£ÈîÅÊèêÁé∞ÂäüËÉΩ')) {
                return;
            }
            
            try {
                const response = await fetch(`${API_BASE}/dev/grant-test-access`, {
                    method: 'POST',
                    headers: { 
                        'Authorization': `Bearer ${authToken}`,
                        'Content-Type': 'application/json'
                    }
                });
                
                const data = await response.json();
                
                if (data.success) {
                    // Âà∑Êñ∞ÂèØÊäΩÂ•ñÊ¨°Êï∞
                    await loadAvailableSpins();
                    alert(data.message + '\n\nÈ°µÈù¢Âç≥Â∞ÜÂà∑Êñ∞ÊòæÁ§∫ÊúÄÊñ∞Áä∂ÊÄÅ');
                    window.location.reload();
                } else {
                    alert('Êìç‰ΩúÂ§±Ë¥•: ' + data.error);
                }
            } catch (error) {
                alert('Êìç‰ΩúÂ§±Ë¥•: ' + error.message);
            }
        }

        // ÂÆåÊàêÊâÄÊúâ‰ªªÂä°
        async function completeAllTasks() {
            if (!confirm('Á°ÆÂÆöË¶ÅÂÆåÊàêÊâÄÊúâ‰ªªÂä°ÂêóÔºü\n\nÂ∞Ü‰ºöËá™Âä®ÂÆåÊàêÊâÄÊúâÂèØÁî®ÁöÑ‰ªªÂä°')) {
                return;
            }
            
            try {
                const response = await fetch(`${API_BASE}/dev/complete-all-tasks`, {
                    method: 'POST',
                    headers: { 
                        'Authorization': `Bearer ${authToken}`,
                        'Content-Type': 'application/json'
                    }
                });
                
                const data = await response.json();
                
                if (data.success) {
                    alert(data.message + '\n\nÈ°µÈù¢Âç≥Â∞ÜÂà∑Êñ∞ÊòæÁ§∫ÊúÄÊñ∞Áä∂ÊÄÅ');
                    window.location.reload();
                } else {
                    alert('Êìç‰ΩúÂ§±Ë¥•: ' + data.error);
                }
            } catch (error) {
                alert('Êìç‰ΩúÂ§±Ë¥•: ' + error.message);
            }
        }

        // ÈáçÁΩÆË¥¶Âè∑
        async function resetAccount() {
            if (!confirm('‚ö†Ô∏è Ë≠¶ÂëäÔºÅ\n\nÁ°ÆÂÆöË¶ÅÈáçÁΩÆË¥¶Âè∑ÂêóÔºü\n\nËøôÂ∞ÜÊ∏ÖÁ©∫ÊâÄÊúâÊï∞ÊçÆÔºåÂåÖÊã¨Ôºö\n- ‰ΩôÈ¢ù\n- ÊäΩÂ•ñËÆ∞ÂΩï\n- ‰ªªÂä°ËøõÂ∫¶\n- ÈÇÄËØ∑ËÆ∞ÂΩï\n\nÊ≠§Êìç‰Ωú‰∏çÂèØÊÅ¢Â§çÔºÅ')) {
                return;
            }
            
            try {
                const response = await fetch(`${API_BASE}/dev/reset-account`, {
                    method: 'POST',
                    headers: { 
                        'Authorization': `Bearer ${authToken}`,
                        'Content-Type': 'application/json'
                    }
                });
                
                const data = await response.json();
                
                if (data.success) {
                    alert(data.message + '\n\nÈ°µÈù¢Âç≥Â∞ÜÂà∑Êñ∞');
                    window.location.reload();
                } else {
                    alert('Êìç‰ΩúÂ§±Ë¥•: ' + data.error);
                }
            } catch (error) {
                alert('Êìç‰ΩúÂ§±Ë¥•: ' + error.message);
            }
        }
        
        // ÂêåÊ≠•ÊäΩÂ•ñÊ¨°Êï∞Ôºà‰øÆÂ§çÊï∞ÊçÆ‰∏ç‰∏ÄËá¥Ôºâ
        async function syncSpins() {
            try {
                const response = await fetch(`${API_BASE}/dev/sync-spins`, {
                    method: 'POST',
                    headers: { 
                        'Authorization': `Bearer ${authToken}`,
                        'Content-Type': 'application/json'
                    }
                });
                
                const data = await response.json();
                
                if (data.success) {
                    await loadAvailableSpins(); // Âà∑Êñ∞ÊòæÁ§∫
                    await toggleDevPanel(); // Âà∑Êñ∞ÂºÄÂèëËÄÖÈù¢Êùø
                    
                    let message = data.message;
                    if (data.data) {
                        message += '\n\nËØ¶ÁªÜ‰ø°ÊÅØÔºö';
                        if (data.data.before) {
                            message += `\n‰øÆÂ§çÂâçÔºöusersË°®=${data.data.before.userSpins}, ËµÑÊ†ºË°®=${data.data.before.entitlementsCount}`;
                        }
                        if (data.data.after) {
                            message += `\n‰øÆÂ§çÂêéÔºöÂ∑≤ÂêåÊ≠•`;
                        }
                    }
                    
                    safeTgAlert(message);
                } else {
                    safeTgAlert('Êìç‰ΩúÂ§±Ë¥•: ' + data.error);
                }
            } catch (error) {
                console.error('ÂêåÊ≠•ÊäΩÂ•ñÊ¨°Êï∞Â§±Ë¥•:', error);
                safeTgAlert('Êìç‰ΩúÂ§±Ë¥•: ' + error.message);
            }
        }

        // Ê£ÄÊü•ÊòØÂê¶ÈÄöËøáÈÇÄËØ∑ÈìæÊé•ËøõÂÖ•
        async function checkInviteCode() {
            try {
                // ‰ªéURLËé∑ÂèñÈÇÄËØ∑Á†ÅÔºàÂ§öÁßçÊñπÂºèÔºâ
                const urlParams = new URLSearchParams(window.location.search);
                
                // ‰ºòÂÖàÁ∫ß1: Áõ¥Êé•‰ªéURLÂèÇÊï∞Ëé∑Âèñ ?invite=CODE
                let inviteCode = urlParams.get('invite');
                
                // ‰ºòÂÖàÁ∫ß2: ‰ªéTelegram startÂèÇÊï∞Ëé∑Âèñ
                if (!inviteCode) {
                    const startParam = urlParams.get('tgWebAppStartParam') || 
                                      (tg.initDataUnsafe?.start_param) ||
                                      urlParams.get('startapp');
                    if (startParam) {
                        inviteCode = startParam;
                    }
                }
                
                console.log('üîç Ê£ÄÊü•ÈÇÄËØ∑Á†ÅËØ¶ÊÉÖ:', { 
                    inviteCode,
                    urlSearch: window.location.search, 
                    urlInvite: urlParams.get('invite'),
                    tgWebAppStartParam: urlParams.get('tgWebAppStartParam'),
                    start_param: tg.initDataUnsafe?.start_param,
                    fullUrl: window.location.href
                });
                
                if (inviteCode) {
                    console.log('‚úÖ ÂèëÁé∞ÈÇÄËØ∑Á†Å:', inviteCode);
                    
                    // ÁôªÂΩï
                    if (!authToken || authToken === 'dev-token') {
                        await login();
                    }

                    // Êèê‰∫§ÈÇÄËØ∑Á†Å
                    const response = await fetch(`${API_BASE}/invite/accept`, {
                        method: 'POST',
                        headers: {
                            'Authorization': `Bearer ${authToken}`,
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({ inviteCode: inviteCode })
                    });

                    const data = await response.json();
                    console.log('ÈÇÄËØ∑Á†ÅÂ§ÑÁêÜÁªìÊûú:', data);
                    
                    if (data.success) {
                        // ÊòæÁ§∫ÈÇÄËØ∑ÊàêÂäüÊèêÁ§∫
                        if (data.data.is_first_invite) {
                            setTimeout(() => {
                                alert('üéâ Ê¨¢ËøéÔºÅ‰Ω†ÁöÑÈÇÄËØ∑‰∫∫Ëé∑Âæó‰∫Ü‰∏ÄÊ¨°ÊäΩÂ•ñÊú∫‰ºöÔºÅ');
                            }, 1000);
                        }
                    } else {
                        console.warn('ÈÇÄËØ∑Á†ÅÂ§ÑÁêÜÂ§±Ë¥•:', data.message);
                    }
                } else {
                    console.log('Êú™ÂèëÁé∞ÈÇÄËØ∑Á†Å');
                }
            } catch (error) {
                console.error('Â§ÑÁêÜÈÇÄËØ∑Á†ÅÈîôËØØ:', error);
            }
        }

        // Â§ÑÁêÜÈ¶ñÊ¨°Ê∏∏Áé©ÔºàÂÖçË¥πÔºâÊàñÂêéÁª≠‰ªòË¥πÊ∏∏Áé©
        async function handleFirstPlay() {
            try {
                // Ê£ÄÊü•Áî®Êà∑ÊòØÂê¶Â∑≤ÁªèÁé©Ëøá
                const response = await fetch(`${API_BASE}/user/play-status`, {
                    headers: {
                        'Authorization': `Bearer ${authToken}`
                    }
                });
                
                const data = await response.json();
                
                if (data.hasPlayed) {
                    // Â∑≤ÁªèÁé©ËøáÔºåÈúÄË¶Å‰ªòË¥π
                    handlePaidMode();
                } else {
                    // È¶ñÊ¨°Ê∏∏Áé©ÔºåÂÖçË¥π
                    localStorage.setItem('gameMode', 'first-time-free');
                    localStorage.setItem('isFirstPlay', 'true');
                    localStorage.removeItem('gameCompleted');
                    window.location.href = '/game/index.html';
                }
            } catch (error) {
                console.error('Ê£ÄÊü•Ê∏∏Áé©Áä∂ÊÄÅÂ§±Ë¥•:', error);
                // ÈªòËÆ§ÂÖÅËÆ∏Ê∏∏Áé©
                localStorage.setItem('gameMode', 'first-time-free');
                localStorage.setItem('isFirstPlay', 'true');
                localStorage.removeItem('gameCompleted');
                window.location.href = '/game/index.html';
            }
        }

        // Â§ÑÁêÜ‰ªòË¥πÊ®°Âºè
        function handlePaidMode() {
            safeTgAlert('Âç≥Â∞ÜË∑≥ËΩ¨Âà∞Á¨¨‰∏âÊñπÊîØ‰ªòÈ°µÈù¢ÔºåÊîØ‰ªòÂÆåÊàêÂêéËøîÂõûÂç≥ÂèØÂºÄÂßãÊ∏∏Êàè');
            // Á¨¨‰∏âÊñπÊîØ‰ªòÈõÜÊàêÔºàÂæÖÂÆûÁé∞Ôºâ
        }

        // Âä†ËΩΩÂèØÊäΩÂ•ñÊ¨°Êï∞
        async function loadAvailableSpins() {
            try {
                if (!authToken || authToken === 'dev-token') {
                    console.log('Êú™ÁôªÂΩïÔºåË∑≥ËøáÂä†ËΩΩÊäΩÂ•ñÊ¨°Êï∞');
                    return;
                }

                const response = await fetch(`${API_BASE}/spin/available`, {
                    headers: { 'Authorization': `Bearer ${authToken}` }
                });

                if (response.ok) {
                    const data = await response.json();
                    if (data.success) {
                        const spins = data.data.available_spins || 0;
                        const availableSpinsEl = document.getElementById('availableSpins');
                        if (availableSpinsEl) {
                            availableSpinsEl.textContent = spins;
                            // Â¶ÇÊûúÊúâÊäΩÂ•ñÊ¨°Êï∞ÔºåÊ∑ªÂä†Âä®ÁîªÊïàÊûú
                            if (spins > 0) {
                                availableSpinsEl.style.animation = 'pulse 1s ease-in-out infinite';
                            } else {
                                availableSpinsEl.style.animation = 'none';
                            }
                        }
                        console.log('‚úÖ ÂèØÊäΩÂ•ñÊ¨°Êï∞:', spins);
                    }
                } else if (response.status === 401) {
                    console.log('TokenÊó†ÊïàÔºåÈúÄË¶ÅÈáçÊñ∞ÁôªÂΩï');
                    authToken = null;
                    localStorage.removeItem('authToken');
                }
            } catch (error) {
                console.error('Âä†ËΩΩÂèØÊäΩÂ•ñÊ¨°Êï∞Â§±Ë¥•:', error);
            }
        }

        // ÂàùÂßãÂåñ
        async function init() {
            console.log('=== Â∫îÁî®ÂàùÂßãÂåñ ===');
            console.log('isDevelopment:', isDevelopment);
            console.log('tg.initDataÂ≠òÂú®:', !!tg.initData);
            
            if (isDevelopment) {
                console.log('‚ö†Ô∏è Development mode - Âú®ÊµèËßàÂô®‰∏≠ÊâìÂºÄ');
            } else {
                console.log('‚úÖ Telegram ÁéØÂ¢É');
                
                // Â∞ùËØïËá™Âä®ÁôªÂΩï
                try {
                    console.log('ÂºÄÂßãËá™Âä®ÁôªÂΩï...');
                    await login();
                    console.log('‚úÖ Ëá™Âä®ÁôªÂΩïÊàêÂäü');
                } catch (error) {
                    console.error('‚ùå Ëá™Âä®ÁôªÂΩïÂ§±Ë¥•:', error);
                    // ÁôªÂΩïÂ§±Ë¥•‰∏çÈòªÊ≠¢È°µÈù¢Âä†ËΩΩÔºåÁî®Êà∑Êìç‰ΩúÊó∂‰ºöÈáçËØï
                }
            }
            
            // Ê£ÄÊü•ÈÇÄËØ∑Á†Å
            await checkInviteCode();
            
            // Âä†ËΩΩËÉΩÈáèÊù°Êï∞ÊçÆ
            await checkTaskProgress();
            
            // Âä†ËΩΩÂèØÊäΩÂ•ñÊ¨°Êï∞
            await loadAvailableSpins();
            
            // Â§ÑÁêÜÊ∏∏ÊàèÂÆåÊàêÂ•ñÂä±ÔºàÂøÖÈ°ªÂú®ÁôªÂΩïÂêéÔºâ
            await handleGameCompletedReward();
            
            // ÂêØÂä®ÈÇÄËØ∑ÁªüËÆ°ËΩÆËØ¢ÔºàÊØè30ÁßíÊ£ÄÊü•‰∏ÄÊ¨°Ôºâ
            if (!isDevelopment && authToken) {
                startInvitePolling();
            }
            
            console.log('=== ÂàùÂßãÂåñÂÆåÊàê ===');
        }

        // È°µÈù¢ÂàáÊç¢ÂáΩÊï∞
        async function switchPage(pageId, event) {
            console.log('ÂàáÊç¢Âà∞È°µÈù¢:', pageId);
            
            // ÈöêËóèÊâÄÊúâÈ°µÈù¢
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            
            // Êõ¥Êñ∞ÂØºËà™Ê†èÁä∂ÊÄÅ
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            
            // ÊòæÁ§∫ÁõÆÊ†áÈ°µÈù¢
            const targetPage = document.getElementById(pageId);
            if (targetPage) {
                targetPage.classList.add('active');
            }
            
            // ÊøÄÊ¥ªÂØπÂ∫îÂØºËà™È°πÔºàÂ¶ÇÊûúÊòØÈÄöËøáÁÇπÂáªËß¶ÂèëÁöÑÔºâ
            if (event && event.target) {
                const navItem = event.target.closest('.nav-item');
                if (navItem) {
                    navItem.classList.add('active');
                }
            } else {
                // ÁºñÁ®ãÊñπÂºèË∞ÉÁî®ÔºåÊ†πÊçÆpageIdÊøÄÊ¥ªÂØπÂ∫îÁöÑnav-item
                const navItems = document.querySelectorAll('.nav-item');
                navItems.forEach(item => {
                    const itemPageId = item.getAttribute('onclick')?.match(/switchPage\('([^']+)'/);
                    if (itemPageId && itemPageId[1] === pageId) {
                        item.classList.add('active');
                    }
                });
            }
            
            // Â¶ÇÊûúÂàáÊç¢Âà∞ÊéíË°åÊ¶úÈ°µÈù¢ÔºåÂä†ËΩΩÊï∞ÊçÆ
            if (pageId === 'leaderboardPage') {
                loadLeaderboard();
            }
            
            // Â¶ÇÊûúÂàáÊç¢Âà∞ÊäΩÂ•ñÈ°µÈù¢ÔºåÂà∑Êñ∞‰ΩôÈ¢ù
            if (pageId === 'spinPage') {
                console.log('üîÑ ÂàáÊç¢Âà∞ÊäΩÂ•ñÈ°µÈù¢ÔºåÂà∑Êñ∞‰ΩôÈ¢ùÊòæÁ§∫');
                checkTaskProgress();
            }
            
            // Â¶ÇÊûúÂàáÊç¢Âà∞ÈÇÄËØ∑È°µÈù¢ÔºåÁ´ãÂç≥Ê£ÄÊü•ÈÇÄËØ∑Êõ¥Êñ∞
            if (pageId === 'invitePage') {
                console.log('üîÑ ÂàáÊç¢Âà∞ÈÇÄËØ∑È°µÈù¢ÔºåÁ´ãÂç≥Ê£ÄÊü•ÈÇÄËØ∑Êõ¥Êñ∞');
                await checkInviteUpdates();
            }
        }

        // ÈöèÊú∫ÁîüÊàêÂç∞Â∫¶ÂêçÂ≠ó
        function generateIndianName() {
            const firstNames = [
                'Raj', 'Amit', 'Priya', 'Sunita', 'Vikram', 'Anjali', 'Ravi', 'Deepika',
                'Arjun', 'Kavya', 'Rohan', 'Neha', 'Aditya', 'Pooja', 'Sanjay', 'Meera',
                'Karan', 'Divya', 'Rahul', 'Sneha', 'Akash', 'Shreya', 'Nikhil', 'Ishita',
                'Varun', 'Ritika', 'Abhishek', 'Tanvi', 'Siddharth', 'Nisha', 'Gaurav', 'Simran',
                'Manish', 'Preeti', 'Vishal', 'Aarti', 'Ajay', 'Swati', 'Suresh', 'Geeta'
            ];
            const lastNames = [
                'Kumar', 'Singh', 'Sharma', 'Patel', 'Gupta', 'Reddy', 'Verma', 'Rao',
                'Chopra', 'Malhotra', 'Kapoor', 'Mehta', 'Nair', 'Joshi', 'Iyer', 'Khan',
                'Das', 'Bose', 'Mukherjee', 'Sinha', 'Pandey', 'Mishra', 'Agarwal', 'Bansal'
            ];
            
            const firstName = firstNames[Math.floor(Math.random() * firstNames.length)];
            const lastName = lastNames[Math.floor(Math.random() * lastNames.length)];
            return `${firstName} ${lastName}`;
        }

        // ÁîüÊàêÈöèÊú∫ÊèêÁé∞ÈáëÈ¢ùÔºàÂç∞Â∫¶Âç¢ÊØîÔºâ- Â¢ûÂä†100ÂÄç
        function generateRandomAmount() {
            const amounts = [10000, 15000, 20000, 25000, 30000, 50000, 100000, 150000, 200000];
            return amounts[Math.floor(Math.random() * amounts.length)];
        }

        // Êõ¥Êñ∞ÊèêÁé∞ÈÄöÁü•ÔºàÈÄöÁî®ÂáΩÊï∞ÔºåÊîØÊåÅÂ§ö‰∏™ÂÖÉÁ¥†Ôºâ
        function updateWithdrawalNotice() {
            const noticeElements = document.querySelectorAll('[data-withdrawal-notice]');
            if (noticeElements.length === 0) return;
            
            const name = generateIndianName();
            const amount = generateRandomAmount();
            const timeAgo = Math.floor(Math.random() * 30) + 1; // 1-30ÂàÜÈíüÂâç
            const formattedAmount = formatPrizeAmount(amount);
            
            noticeElements.forEach(element => {
                element.textContent = `üéâ ÊÅ≠Âñú ${name} ÊàêÂäüÊèêÁé∞ ${formattedAmount} Âç¢ÊØîÔºÅ(${timeAgo}ÂàÜÈíüÂâç)    `;
            });
        }

        // ÂÆöÊúüÊõ¥Êñ∞ÈÄöÁü• - Âä†Âø´ÊªöÂä®ÈÄüÂ∫¶Ôºà‰ªé8ÁßíÊîπ‰∏∫5ÁßíÔºâ
        setInterval(updateWithdrawalNotice, 5000);

        // ÁîüÊàêËôöÂÅáÂç∞Â∫¶Áî®Êà∑ÊéíË°åÊ¶úÊï∞ÊçÆ
        function generateFakeLeaderboard() {
            const indianNames = [
                { name: 'Rajesh Kumar', spins: 7143 },
                { name: 'Priya Sharma', spins: 6892 },
                { name: 'Amit Patel', spins: 6543 },
                { name: 'Sneha Gupta', spins: 6234 },
                { name: 'Vikram Singh', spins: 5987 },
                { name: 'Anjali Reddy', spins: 5678 },
                { name: 'Rohit Verma', spins: 5432 },
                { name: 'Pooja Iyer', spins: 5234 },
                { name: 'Arjun Mehta', spins: 4987 },
                { name: 'Kavita Desai', spins: 4765 },
                { name: 'Rahul Joshi', spins: 4543 },
                { name: 'Neha Shah', spins: 4321 },
                { name: 'Sanjay Pillai', spins: 4123 },
                { name: 'Deepika Nair', spins: 3987 },
                { name: 'Anil Kapoor', spins: 3765 },
                { name: 'Swati Malhotra', spins: 3543 },
                { name: 'Karan Thakur', spins: 3321 },
                { name: 'Ritu Bansal', spins: 3123 },
                { name: 'Manoj Rao', spins: 2987 },
                { name: 'Shruti Bose', spins: 2765 },
                { name: 'Suresh Chopra', spins: 2543 },
                { name: 'Meera Kulkarni', spins: 2321 },
                { name: 'Ashok Sinha', spins: 2123 },
                { name: 'Divya Mishra', spins: 1987 },
                { name: 'Vikas Agarwal', spins: 1765 },
                { name: 'Nidhi Saxena', spins: 1543 },
                { name: 'Sandeep Yadav', spins: 1321 },
                { name: 'Isha Pandey', spins: 1123 },
                { name: 'Rakesh Tiwari', spins: 987 },
                { name: 'Tanvi Bhatt', spins: 865 }
            ];

            return indianNames.map((user, index) => {
                // ËÆ°ÁÆóÊèêÁé∞ÈáëÈ¢ùÔºöÊäΩÂ•ñÊ¨°Êï∞ * (7000-10000)ÈöèÊú∫ÊØî‰æã
                const ratio = 7000 + Math.random() * 3000;
                const amount = user.spins * ratio;
                
                // ÁîüÊàêÈöèÊú∫Êó•ÊúüÔºàÊúÄËøë30Â§©ÂÜÖÔºâ
                const daysAgo = Math.floor(Math.random() * 30);
                const date = new Date();
                date.setDate(date.getDate() - daysAgo);
                
                return {
                    rank: index + 1,
                    name: user.name,
                    spins: user.spins,
                    amount: amount,
                    date: date,
                    status: Math.random() > 0.3 ? 'completed' : 'pending'
                };
            });
        }

        // Âä†ËΩΩÊéíË°åÊ¶úÊï∞ÊçÆ
        async function loadLeaderboard() {
            // È¶ñÊ¨°Âä†ËΩΩÊó∂ÂàùÂßãÂåñÈÄöÁü•
            updateWithdrawalNotice();
            const container = document.getElementById('leaderboardContainer');
            
            try {
                container.innerHTML = `
                    <div style="text-align: center; padding: 40px 20px; color: rgba(255,255,255,0.6);">
                        <div style="font-size: 48px; margin-bottom: 15px;">‚è≥</div>
                        <p>Âä†ËΩΩ‰∏≠...</p>
                    </div>
                `;
                
                // ÁîüÊàêËôöÂÅáÊéíË°åÊ¶úÊï∞ÊçÆ
                const fakeData = generateFakeLeaderboard();
                
                // Ê∏≤ÊüìÊéíË°åÊ¶ú
                let html = '';
                fakeData.forEach((item) => {
                    const rankClass = item.rank <= 3 ? `top-${item.rank}` : '';
                    const statusClass = item.status === 'completed' ? 'completed' : 'pending';
                    const statusText = item.status === 'completed' ? 'Â∑≤ÂÆåÊàê' : 'ÂÆ°Ê†∏‰∏≠';
                    
                    html += `
                        <div class="leaderboard-item">
                            <div class="leaderboard-rank ${rankClass}">${item.rank}</div>
                            <div class="leaderboard-info">
                                <div class="leaderboard-name">${item.name}</div>
                                <div class="leaderboard-detail">
                                    ÊäΩÂ•ñÊ¨°Êï∞: ${item.spins.toLocaleString('en-IN')} Ê¨°
                                    <span class="leaderboard-status ${statusClass}">${statusText}</span>
                                </div>
                            </div>
                            <div class="leaderboard-amount">‚Çπ${item.amount.toLocaleString('en-IN', {minimumFractionDigits: 2, maximumFractionDigits: 2})}</div>
                        </div>
                    `;
                });
                
                container.innerHTML = html;
                
            } catch (error) {
                console.error('Âä†ËΩΩÊéíË°åÊ¶úÂ§±Ë¥•:', error);
                container.innerHTML = `
                    <div style="text-align: center; padding: 40px 20px; color: rgba(255,255,255,0.6);">
                        <div style="font-size: 48px; margin-bottom: 15px;">‚ùå</div>
                        <p>Âä†ËΩΩÂ§±Ë¥•</p>
                        <button onclick="loadLeaderboard()" style="margin-top: 15px; padding: 10px 25px; background: rgba(255,153,51,0.3); border: none; border-radius: 10px; color: white; cursor: pointer;">
                            üîÑ ÈáçÊñ∞Âä†ËΩΩ
                        </button>
                    </div>
                `;
            }
        }

        // Â§ÑÁêÜÊ∏∏ÊàèÂÆåÊàêÂ•ñÂä±ÔºàÂú®ÁôªÂΩïÂêéË∞ÉÁî®Ôºâ
        async function handleGameCompletedReward() {
            console.log('üîç Ê£ÄÊü•Ê∏∏ÊàèÂÆåÊàêÁä∂ÊÄÅ...');
            const gameCompleted = localStorage.getItem('gameCompleted');
            const gameScore = localStorage.getItem('gameScore');
            
            console.log('üìä Ê∏∏ÊàèÁä∂ÊÄÅ:', { gameCompleted, gameScore });
            
            if (gameCompleted === 'true') {
                console.log('üéÆ Ê£ÄÊµãÂà∞Ê∏∏ÊàèÂÆåÊàêÔºåÂèëÊîæÂ•ñÂä±');
                // ‚ö†Ô∏è Á´ãÂç≥Ê∏ÖÈô§Ê†áËÆ∞ÔºåÈÅøÂÖçÈáçÂ§çÂèëÊîæ
                localStorage.removeItem('gameCompleted');
                localStorage.removeItem('gameScore');
                
                // ÊØèÊ¨°Ê∏∏ÊàèÂÆåÊàêÈÉΩËµ†ÈÄÅÊäΩÂ•ñÊú∫‰ºö
                if (!authToken || authToken === 'dev-token') {
                    console.error('‚ùå Ê≤°ÊúâÊúâÊïàÁöÑtokenÔºåÊó†Ê≥ïÈ¢ÜÂèñÂ•ñÂä±');
                    return;
                }
                
                try {
                    console.log('üì° Ë∞ÉÁî®Ê∏∏ÊàèÂÆåÊàêÂ•ñÂä±API...');
                    const response = await fetch(`${API_BASE}/user/game-reward`, {
                        method: 'POST',
                        headers: {
                            'Authorization': `Bearer ${authToken}`,
                            'Content-Type': 'application/json'
                        }
                    });
                    
                    console.log('üì° APIÂìçÂ∫îÁä∂ÊÄÅ:', response.status);
                    const result = await response.json();
                    console.log('üéÅ Ê∏∏ÊàèÂ•ñÂä±ÂìçÂ∫î:', result);
                    
                    if (response.ok && result.success) {
                        // ÈáçÊñ∞Âä†ËΩΩÊäΩÂ•ñÊ¨°Êï∞Âíå‰ΩôÈ¢ù
                        await loadAvailableSpins();
                        await checkTaskProgress(); // Âà∑Êñ∞‰ΩôÈ¢ùÊòæÁ§∫
                        console.log('‚úÖ Ê∏∏ÊàèÂ•ñÂä±È¢ÜÂèñÊàêÂäü');
                        
                        // ‰ΩøÁî®TelegramÂºπÁ™ó
                        if (window.Telegram?.WebApp) {
                            window.Telegram.WebApp.showPopup({
                                message: 'üéâ ÊÅ≠ÂñúÂÆåÊàêÊ∏∏ÊàèÔºÅÂ∑≤Ëé∑Âæó‰∏ÄÊ¨°ÊäΩÂ•ñÊú∫‰ºöÔºÅ',
                                buttons: [{type: 'ok', text: 'Â•ΩÁöÑ'}]
                            }, function() {
                                console.log('üéØ Áî®Êà∑ÂÖ≥Èó≠ÂºπÁ™óÔºåÁ°Æ‰øùÂú®ÊäΩÂ•ñÈ°µÈù¢');
                                // Ê∏ÖÈô§URL‰∏≠ÁöÑpageÂèÇÊï∞ÔºåÈÅøÂÖçÂà∑Êñ∞ÂêéÂÜçÊ¨°Ëß¶ÂèëË∑≥ËΩ¨
                                if (window.location.search.includes('page=')) {
                                    window.history.replaceState({}, '', window.location.pathname);
                                }
                                // Á°Æ‰øùÂú®ÊäΩÂ•ñÈ°µÈù¢ÔºàÂèØËÉΩÂ∑≤ÁªèÂú®‰∫ÜÔºâ
                                const currentPage = document.querySelector('.page.active');
                                if (currentPage && currentPage.id !== 'spinPage') {
                                    switchPage('spinPage');
                                } else {
                                    console.log('‚úÖ Â∑≤ÁªèÂú®ÊäΩÂ•ñÈ°µÈù¢ÔºåÊó†ÈúÄÂàáÊç¢');
                                }
                            });
                        } else {
                            alert('üéâ ÊÅ≠ÂñúÂÆåÊàêÊ∏∏ÊàèÔºÅÂ∑≤Ëé∑Âæó‰∏ÄÊ¨°ÊäΩÂ•ñÊú∫‰ºöÔºÅ');
                            // Ê∏ÖÈô§URL‰∏≠ÁöÑpageÂèÇÊï∞
                            if (window.location.search.includes('page=')) {
                                window.history.replaceState({}, '', window.location.pathname);
                            }
                            // Á°Æ‰øùÂú®ÊäΩÂ•ñÈ°µÈù¢
                            const currentPage = document.querySelector('.page.active');
                            if (currentPage && currentPage.id !== 'spinPage') {
                                switchPage('spinPage');
                            }
                        }
                    } else {
                        console.error('‚ùå È¢ÜÂèñÊ∏∏ÊàèÂ•ñÂä±Â§±Ë¥•:', result);
                    }
                } catch (error) {
                    console.error('‚ùå È¢ÜÂèñÊ∏∏ÊàèÂ•ñÂä±ÂºÇÂ∏∏:', error);
                }
            }
        }

        // È°µÈù¢Âä†ËΩΩÂêéÁ´ãÂç≥Ê£ÄÊü•ÂºÄÂèëËÄÖÊùÉÈôêÔºàÈíàÂØπÂ∑≤ÁôªÂΩïÁî®Êà∑Ôºâ
        document.addEventListener('DOMContentLoaded', async () => {
            console.log('üì± È°µÈù¢DOMÂä†ËΩΩÂÆåÊàê');
            
            // Ê£ÄÊü•URLÂèÇÊï∞ÔºåÁúãÊòØÂê¶ÈúÄË¶ÅË∑≥ËΩ¨Âà∞ÁâπÂÆöÈ°µÈù¢
            const urlParams = new URLSearchParams(window.location.search);
            const targetPage = urlParams.get('page');
            
            // Â¶ÇÊûúURLÊåáÂÆöË∑≥ËΩ¨Âà∞ÊäΩÂ•ñÈ°µÈù¢ÔºàÊ∏∏ÊàèÂÆåÊàêÂêéË∑≥ËΩ¨Ôºâ
            if (targetPage === 'spin') {
                console.log('üéØ URLÂèÇÊï∞ÊåáÂÆöË∑≥ËΩ¨Âà∞ÊäΩÂ•ñÈ°µÈù¢');
                // ‰∏çÁ´ãÂç≥Ë∑≥ËΩ¨ÔºåÁ≠âÂæÖÁôªÂΩïÂÆåÊàêÂêéÂú®init‰∏≠Â§ÑÁêÜ
            }
            
            // Â¶ÇÊûúÂ∑≤ÁªèÊúâ tokenÔºåÁ´ãÂç≥Ê£ÄÊü•ÂºÄÂèëËÄÖÊùÉÈôê
            const savedToken = localStorage.getItem('authToken');
            if (savedToken && savedToken !== 'dev-token') {
                console.log('üîë ÂèëÁé∞Â∑≤‰øùÂ≠òÁöÑ tokenÔºåÁ´ãÂç≥Ê£ÄÊü•ÂºÄÂèëËÄÖÊùÉÈôê');
                authToken = savedToken;
                await checkDevAccess();
            }
            
            // ÂàùÂßãÂåñÊèêÁé∞ÈÄöÁü•
            updateWithdrawalNotice();
        });

        // ÁõëÂê¨È°µÈù¢ÂèØËßÅÊÄßÂèòÂåñÔºàÁî®Êà∑ËøîÂõûÂ∫îÁî®Êó∂Á´ãÂç≥Ê£ÄÊü•ÈÇÄËØ∑Êõ¥Êñ∞Ôºâ
        document.addEventListener('visibilitychange', () => {
            if (!document.hidden && authToken && authToken !== 'dev-token') {
                console.log('üì± Áî®Êà∑ËøîÂõûÂ∫îÁî®ÔºåÁ´ãÂç≥Ê£ÄÊü•ÈÇÄËØ∑Êõ¥Êñ∞');
                checkInviteUpdates();
            }
        });

        // ÁõëÂê¨Telegram WebAppÁöÑÁÑ¶ÁÇπ‰∫ã‰ª∂
        if (window.Telegram?.WebApp) {
            window.Telegram.WebApp.onEvent('viewportChanged', () => {
                if (window.Telegram.WebApp.isExpanded && authToken && authToken !== 'dev-token') {
                    console.log('üì± Â∫îÁî®Â±ïÂºÄÔºåÊ£ÄÊü•ÈÇÄËØ∑Êõ¥Êñ∞');
                    checkInviteUpdates();
                }
            });
        }

        init();
    </script>
</body>

</html>
